1 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
2 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
3 // MM                                                                                                                                                            MM
4 // MM   ^                                    #####  #####   ####       # ######  ####  #####    #      # #    # #    #  ####                                     MM
5 // MM   |                                    #    # #    # #    #      # #      #    #   #      #      # ##   # #   #  #                                         MM
6 // MM   |                                    #    # #    # #    #      # #####  #        #      #      # # #  # ####    ####                                     MM
7 // MM   ^                                    #####  #####  #    #      # #      #        #      #      # #  # # #  #        #                                    MM
8 // MM   |                                    #      #   #  #    # #    # #      #    #   #      #      # #   ## #   #  #    #                                    MM
9 // MM   |                                    #      #    #  ####   ####  ######  ####    #      ###### # #    # #    #  ####                                     MM
10 // MM   ^                                                                                                                                                        MM
11 // MM   |                                                                                                                                                        MM
12 // MM   |________ Click 'Read Contract', then select:                                                                                                            MM
13 // MM                * _1___website                                                                                                                              MM
14 // MM                * _2___twitter (or X...)                                                                                                                    MM
15 // MM                * _3___telegram                                                                                                                             MM
16 // MM                * _4___discord                                                                                                                              MM
17 // MM                                                                                                                                                            MM
18 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
19 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
20 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXKXWMMMMM
21 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0dccdKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0d:,;dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc,.,xNMMMM
22 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOo;..  .oWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNOo;..   .kMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0d:..    ;KMMMM
23 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkl,.      .lNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkl,..      .kMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOo;..       ;KMMMM
24 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc'.         .lNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkl,.          .kMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkl,.           ;KMMMM
25 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0d:'.            .lNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc'.             .kMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc'.              ;KMMMM
26 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0d:..               .lNMMMMMMMMMMMMMMMMMMMMMMMMMMN0d:..                .kMMMMMMMMMMMMMMMMMMMMMMMMMWKxc'.                 ;KMMMM
27 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOo;..                  .lNMMMMMMMMMMMMMMMMMMMMMMNOxo;..                   .kMMMMMMMMMMMMMMMMMMMMMMN0d:..                    ;KMMMM
28 // MMMMMMMMMMMMMMMMMMMMMMMMMWXkl,.                      .lNMMMMMMMMMMMMMMMMMMWXOo,...                      .kMMMMMMMMMMMMMMMMMMMNOo;..                       ;KMMMM
29 // MMMMMMMMMMMMMMMMMMMMMMWKxc'.                         .lNMMMMMMMMMMMMMMMWXkl,.                           .kMMMMMMMMMMMMMMMWXkl,.                           ;KMMMM
30 // MMMMMMMMMMMMMMMMMMMW0d:'.                            .lNMMMMMMMMMMMMWKxc'.                              .kMMMMMMMMMMMMWKkc'.                              ;KMMMM
31 // MMMMMMMMMMMMMMMMN0d:..                               .cXMMMMMMMMMN0d:..                                 .oWMMMMMMMMWKxc'.                                 ;KMMMM
32 // MMMMMMMMMMMMWNOo;..                                   .lKWMMMWNOo;..                                     .oKWMMWN0d:..                                    ;KMMMM
33 // MMMMMMMMMWXkl,.                                        .'codol,..                                         ..;clc,..                                       ;KMMMM
34 // MMMMMMWKxc'.                                                                                                                                              :XMMMM
35 // MMMMXxc'.                                                                                                                                                'kWMMMM
36 // MMW0:.                                                                                                                                                ..:OWMMMMM
37 // MMK:.                                                                                                                                              ..;o0NMMMMMMM
38 // MMO'                                         .....                                             ..''..                                           ..:d0NMMMMMMMMMM
39 // MMO'                                     ..,lxO0Oxc..                                       .'cx0XXKkc..                                     .'cxKWMMMMMMMMMMMMM
40 // MMO'                                  ..;oOXWMMMMMWO,                                   ..,lkXWMMMMMMWx.                                  .,lkXWMMMMMMMMMMMMMMMM
41 // MMO'                               ..:d0NMMMMMMMMMMNo.                               ..;oONWMMMMMMMMMMK;                               .,oOXWMMMMMMMMMMMMMMMMMMM
42 // MMO'                            ..:d0NMMMMMMMMMMMMMWo.                            ..:d0NMMMMMMMMMMMMMMX:                           ..;oONMMMMMMMMMMMMMMMMMMMMMMM
43 // MMO'                         .'cxKWMMMMMMMMMMMMMMMMWo.                        .';cxKWMMMMMMMMMMMMMMMMMX:                        ..:d0NMMMMMMMMMMMMMMMMMMMMMMMMMM
44 // MMO'                      .,lkXWMMMMMMMMMMMMMMMMMMMWo.                     .,ckKNWMMMMMMMMMMMMMMMMMMMMX:                     .'cxKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
45 // MMO'                  ..;oOXMMMMMMMMMMMMMMMMMMMMMMMWo.                 ..,lkXWMMMMMMMMMMMMMMMMMMMMMMMMX:                  .,lkXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
46 // MMO'               ..:d0NMMMMMMMMMMMMMMMMMMMMMMMMMMWo.              ..;oONWMMMMMMMMMMMMMMMMMMMMMMMMMMMX:              ..,oOXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
47 // MMO'            ..:d0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWo.           ..:d0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMX:           ..;oONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
48 // MMO'         .'cxKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWo.        .'cxKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMX:        ..:d0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
49 // MMO'      .,lkXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWo.     .'ckKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMX:     .'cxKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
50 // MM0,  ..;oOXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWk'. .,lkXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNd...,lkXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
51 // MMW0dld0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0xxONWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKO0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
52 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
53 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
54 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
55 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
56 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
57 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
58 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
59 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
60 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
61 // MMMWX00000XWMMMMMMWX00000KWMNK000000000000KWNK0000000000000KXWMMWX0000KNMMMMMMMNKK00000000KKNWMMMMMWX000000000KKXWMMMMMMMMMWXK0OO0KXWMMMMMMNK000000000KXNMMMMMMM
62 // MMMK:..''.;OMMMMMMK:..'..;0M0;............:00;..............oNMWO;.''..lXMMMMMWd'..........',:d0WMMNl...........':dKMMMMNOo;'......';oONMMMO;..........';lOWMMMM
63 // MMMK; .;;..cXMMMMNo..,;. 'OMO' .,looooooookXXxooooc. .,looodOWM0;..:o' .oNMMMMWo.. .:oooooo:'. .lXMXc. .cdddddo:. .;0MW0:...;lddddl;...:OWMO' .,loooool,. .dNMMM
64 // MMMK;  :d, .xWMMMO, .dc. 'OMO' .lNMMMMMMMMMMMMMMMMO' .lNMMMMMMXc. 'kNo. .xWMMMWo.. .kMMMMMMWKl. .lNXc. ,0MMMMMMNo. .xWO,..;kNMMMMMMNk;. 'kWO' .lNMMMMMM0,  ;KMMM
65 // MMMK;  :0o. ;KMMXc..cKl. 'OMO' .'looooooo0MMMMMMMMO' .lNMMMMMNo. .dWMK:. 'OMMMWo.. .kMMMMMMMMX:. ,OXc. 'xXKXXK0d,..:0Nl. 'kMMMMMMMMMMO' .cXO' .cKXXXXX0o. .lXMMM
66 // MMMK;  :XK: .oNWx. ,ONl. 'OMO'  .''''''',xWMMMMMMMO' .lNMMMMWx. .:0NNNk' .;0MMWo.. .kMMMMMMMMNl. 'OXc. ..........:xXMXc. ,0MMMMMMMMMM0;  :XO'  .'''''....'oXMMMM
67 // MMMK;  :XWx. ,OK:..oNNl. 'OMO' .cKXXXXXXXWMMMMMMMMO' .lNMMMWO,  ..,,,,,.  .cXMWo.. .kMMMMMMMWk, .:KXc. .:ooool:..;oKMWd. .lXMMMMMMMMNo. .oWO' .,looooooxOXWMMMMM
68 // MMMK;  :KMXl..co..:KMNl. 'OMO' .:0KKKKKKKKXWMMMMMMO' .lNMMMK:. .:ccccccc,. .oNWo.. .oKKKKK0kl'..,OWXc. ,0MMMMMNx. .cXMXo. .;d0XXXX0x:. .lXMO' .lNMMMMMMMMMMMMMMM
69 // MMMK;  :XMMO, ....kWMNl. 'OMO'  ..........:KMMMMMMO' .lNMMXc. .oNMMMMMMMK:. .xNo.. ...........,oKWMXc. ,0MMMMMMXc. .dNMWOc'....''....'cONMMk' .lNMMMMMMMMMMMMMMM
70 // MMMNkookNMMWOooookNMMWOooxXMXxooooooooooooxXMMMMMMXxooOWMMKdooxXMMMMMMMMM0dookN0doloooooooodx0NWMMMWOooxXMMMMMMMKdookNMMMWXOxolcclodOXWMMMMXdooOWMMMMMMMMMMMMMMM
71 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
72 // MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
73 
74 // SPDX-License-Identifier: BUSL 1.0
75 // Metadrop Contracts (v2.1.0)
76 
77 // File @openzeppelin/contracts/token/ERC20/IERC20.sol@v4.9.1
78 
79 // 
80 // OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)
81 
82 pragma solidity ^0.8.0;
83 
84 /**
85  * @dev Interface of the ERC20 standard as defined in the EIP.
86  */
87 interface IERC20 {
88     /**
89      * @dev Emitted when `value` tokens are moved from one account (`from`) to
90      * another (`to`).
91      *
92      * Note that `value` may be zero.
93      */
94     event Transfer(address indexed from, address indexed to, uint256 value);
95 
96     /**
97      * @dev Emitted when the allowance of a `spender` for an `owner` is set by
98      * a call to {approve}. `value` is the new allowance.
99      */
100     event Approval(address indexed owner, address indexed spender, uint256 value);
101 
102     /**
103      * @dev Returns the amount of tokens in existence.
104      */
105     function totalSupply() external view returns (uint256);
106 
107     /**
108      * @dev Returns the amount of tokens owned by `account`.
109      */
110     function balanceOf(address account) external view returns (uint256);
111 
112     /**
113      * @dev Moves `amount` tokens from the caller's account to `to`.
114      *
115      * Returns a boolean value indicating whether the operation succeeded.
116      *
117      * Emits a {Transfer} event.
118      */
119     function transfer(address to, uint256 amount) external returns (bool);
120 
121     /**
122      * @dev Returns the remaining number of tokens that `spender` will be
123      * allowed to spend on behalf of `owner` through {transferFrom}. This is
124      * zero by default.
125      *
126      * This value changes when {approve} or {transferFrom} are called.
127      */
128     function allowance(address owner, address spender) external view returns (uint256);
129 
130     /**
131      * @dev Sets `amount` as the allowance of `spender` over the caller's tokens.
132      *
133      * Returns a boolean value indicating whether the operation succeeded.
134      *
135      * IMPORTANT: Beware that changing an allowance with this method brings the risk
136      * that someone may use both the old and the new allowance by unfortunate
137      * transaction ordering. One possible solution to mitigate this race
138      * condition is to first reduce the spender's allowance to 0 and set the
139      * desired value afterwards:
140      * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729
141      *
142      * Emits an {Approval} event.
143      */
144     function approve(address spender, uint256 amount) external returns (bool);
145 
146     /**
147      * @dev Moves `amount` tokens from `from` to `to` using the
148      * allowance mechanism. `amount` is then deducted from the caller's
149      * allowance.
150      *
151      * Returns a boolean value indicating whether the operation succeeded.
152      *
153      * Emits a {Transfer} event.
154      */
155     function transferFrom(address from, address to, uint256 amount) external returns (bool);
156 }
157 
158 
159 // File @openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol@v4.9.1
160 
161 // 
162 // OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/IERC20Metadata.sol)
163 
164 pragma solidity ^0.8.0;
165 
166 /**
167  * @dev Interface for the optional metadata functions from the ERC20 standard.
168  *
169  * _Available since v4.1._
170  */
171 interface IERC20Metadata is IERC20 {
172     /**
173      * @dev Returns the name of the token.
174      */
175     function name() external view returns (string memory);
176 
177     /**
178      * @dev Returns the symbol of the token.
179      */
180     function symbol() external view returns (string memory);
181 
182     /**
183      * @dev Returns the decimals places of the token.
184      */
185     function decimals() external view returns (uint8);
186 }
187 
188 
189 // File @openzeppelin/contracts/utils/structs/EnumerableSet.sol@v4.9.1
190 
191 // 
192 // OpenZeppelin Contracts (last updated v4.9.0) (utils/structs/EnumerableSet.sol)
193 // This file was procedurally generated from scripts/generate/templates/EnumerableSet.js.
194 
195 pragma solidity ^0.8.0;
196 
197 /**
198  * @dev Library for managing
199  * https://en.wikipedia.org/wiki/Set_(abstract_data_type)[sets] of primitive
200  * types.
201  *
202  * Sets have the following properties:
203  *
204  * - Elements are added, removed, and checked for existence in constant time
205  * (O(1)).
206  * - Elements are enumerated in O(n). No guarantees are made on the ordering.
207  *
208  * ```solidity
209  * contract Example {
210  *     // Add the library methods
211  *     using EnumerableSet for EnumerableSet.AddressSet;
212  *
213  *     // Declare a set state variable
214  *     EnumerableSet.AddressSet private mySet;
215  * }
216  * ```
217  *
218  * As of v3.3.0, sets of type `bytes32` (`Bytes32Set`), `address` (`AddressSet`)
219  * and `uint256` (`UintSet`) are supported.
220  *
221  * [WARNING]
222  * ====
223  * Trying to delete such a structure from storage will likely result in data corruption, rendering the structure
224  * unusable.
225  * See https://github.com/ethereum/solidity/pull/11843[ethereum/solidity#11843] for more info.
226  *
227  * In order to clean an EnumerableSet, you can either remove all elements one by one or create a fresh instance using an
228  * array of EnumerableSet.
229  * ====
230  */
231 library EnumerableSet {
232     // To implement this library for multiple types with as little code
233     // repetition as possible, we write it in terms of a generic Set type with
234     // bytes32 values.
235     // The Set implementation uses private functions, and user-facing
236     // implementations (such as AddressSet) are just wrappers around the
237     // underlying Set.
238     // This means that we can only create new EnumerableSets for types that fit
239     // in bytes32.
240 
241     struct Set {
242         // Storage of set values
243         bytes32[] _values;
244         // Position of the value in the `values` array, plus 1 because index 0
245         // means a value is not in the set.
246         mapping(bytes32 => uint256) _indexes;
247     }
248 
249     /**
250      * @dev Add a value to a set. O(1).
251      *
252      * Returns true if the value was added to the set, that is if it was not
253      * already present.
254      */
255     function _add(Set storage set, bytes32 value) private returns (bool) {
256         if (!_contains(set, value)) {
257             set._values.push(value);
258             // The value is stored at length-1, but we add 1 to all indexes
259             // and use 0 as a sentinel value
260             set._indexes[value] = set._values.length;
261             return true;
262         } else {
263             return false;
264         }
265     }
266 
267     /**
268      * @dev Removes a value from a set. O(1).
269      *
270      * Returns true if the value was removed from the set, that is if it was
271      * present.
272      */
273     function _remove(Set storage set, bytes32 value) private returns (bool) {
274         // We read and store the value's index to prevent multiple reads from the same storage slot
275         uint256 valueIndex = set._indexes[value];
276 
277         if (valueIndex != 0) {
278             // Equivalent to contains(set, value)
279             // To delete an element from the _values array in O(1), we swap the element to delete with the last one in
280             // the array, and then remove the last element (sometimes called as 'swap and pop').
281             // This modifies the order of the array, as noted in {at}.
282 
283             uint256 toDeleteIndex = valueIndex - 1;
284             uint256 lastIndex = set._values.length - 1;
285 
286             if (lastIndex != toDeleteIndex) {
287                 bytes32 lastValue = set._values[lastIndex];
288 
289                 // Move the last value to the index where the value to delete is
290                 set._values[toDeleteIndex] = lastValue;
291                 // Update the index for the moved value
292                 set._indexes[lastValue] = valueIndex; // Replace lastValue's index to valueIndex
293             }
294 
295             // Delete the slot where the moved value was stored
296             set._values.pop();
297 
298             // Delete the index for the deleted slot
299             delete set._indexes[value];
300 
301             return true;
302         } else {
303             return false;
304         }
305     }
306 
307     /**
308      * @dev Returns true if the value is in the set. O(1).
309      */
310     function _contains(Set storage set, bytes32 value) private view returns (bool) {
311         return set._indexes[value] != 0;
312     }
313 
314     /**
315      * @dev Returns the number of values on the set. O(1).
316      */
317     function _length(Set storage set) private view returns (uint256) {
318         return set._values.length;
319     }
320 
321     /**
322      * @dev Returns the value stored at position `index` in the set. O(1).
323      *
324      * Note that there are no guarantees on the ordering of values inside the
325      * array, and it may change when more values are added or removed.
326      *
327      * Requirements:
328      *
329      * - `index` must be strictly less than {length}.
330      */
331     function _at(Set storage set, uint256 index) private view returns (bytes32) {
332         return set._values[index];
333     }
334 
335     /**
336      * @dev Return the entire set in an array
337      *
338      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
339      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
340      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
341      * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.
342      */
343     function _values(Set storage set) private view returns (bytes32[] memory) {
344         return set._values;
345     }
346 
347     // Bytes32Set
348 
349     struct Bytes32Set {
350         Set _inner;
351     }
352 
353     /**
354      * @dev Add a value to a set. O(1).
355      *
356      * Returns true if the value was added to the set, that is if it was not
357      * already present.
358      */
359     function add(Bytes32Set storage set, bytes32 value) internal returns (bool) {
360         return _add(set._inner, value);
361     }
362 
363     /**
364      * @dev Removes a value from a set. O(1).
365      *
366      * Returns true if the value was removed from the set, that is if it was
367      * present.
368      */
369     function remove(Bytes32Set storage set, bytes32 value) internal returns (bool) {
370         return _remove(set._inner, value);
371     }
372 
373     /**
374      * @dev Returns true if the value is in the set. O(1).
375      */
376     function contains(Bytes32Set storage set, bytes32 value) internal view returns (bool) {
377         return _contains(set._inner, value);
378     }
379 
380     /**
381      * @dev Returns the number of values in the set. O(1).
382      */
383     function length(Bytes32Set storage set) internal view returns (uint256) {
384         return _length(set._inner);
385     }
386 
387     /**
388      * @dev Returns the value stored at position `index` in the set. O(1).
389      *
390      * Note that there are no guarantees on the ordering of values inside the
391      * array, and it may change when more values are added or removed.
392      *
393      * Requirements:
394      *
395      * - `index` must be strictly less than {length}.
396      */
397     function at(Bytes32Set storage set, uint256 index) internal view returns (bytes32) {
398         return _at(set._inner, index);
399     }
400 
401     /**
402      * @dev Return the entire set in an array
403      *
404      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
405      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
406      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
407      * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.
408      */
409     function values(Bytes32Set storage set) internal view returns (bytes32[] memory) {
410         bytes32[] memory store = _values(set._inner);
411         bytes32[] memory result;
412 
413         /// @solidity memory-safe-assembly
414         assembly {
415             result := store
416         }
417 
418         return result;
419     }
420 
421     // AddressSet
422 
423     struct AddressSet {
424         Set _inner;
425     }
426 
427     /**
428      * @dev Add a value to a set. O(1).
429      *
430      * Returns true if the value was added to the set, that is if it was not
431      * already present.
432      */
433     function add(AddressSet storage set, address value) internal returns (bool) {
434         return _add(set._inner, bytes32(uint256(uint160(value))));
435     }
436 
437     /**
438      * @dev Removes a value from a set. O(1).
439      *
440      * Returns true if the value was removed from the set, that is if it was
441      * present.
442      */
443     function remove(AddressSet storage set, address value) internal returns (bool) {
444         return _remove(set._inner, bytes32(uint256(uint160(value))));
445     }
446 
447     /**
448      * @dev Returns true if the value is in the set. O(1).
449      */
450     function contains(AddressSet storage set, address value) internal view returns (bool) {
451         return _contains(set._inner, bytes32(uint256(uint160(value))));
452     }
453 
454     /**
455      * @dev Returns the number of values in the set. O(1).
456      */
457     function length(AddressSet storage set) internal view returns (uint256) {
458         return _length(set._inner);
459     }
460 
461     /**
462      * @dev Returns the value stored at position `index` in the set. O(1).
463      *
464      * Note that there are no guarantees on the ordering of values inside the
465      * array, and it may change when more values are added or removed.
466      *
467      * Requirements:
468      *
469      * - `index` must be strictly less than {length}.
470      */
471     function at(AddressSet storage set, uint256 index) internal view returns (address) {
472         return address(uint160(uint256(_at(set._inner, index))));
473     }
474 
475     /**
476      * @dev Return the entire set in an array
477      *
478      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
479      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
480      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
481      * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.
482      */
483     function values(AddressSet storage set) internal view returns (address[] memory) {
484         bytes32[] memory store = _values(set._inner);
485         address[] memory result;
486 
487         /// @solidity memory-safe-assembly
488         assembly {
489             result := store
490         }
491 
492         return result;
493     }
494 
495     // UintSet
496 
497     struct UintSet {
498         Set _inner;
499     }
500 
501     /**
502      * @dev Add a value to a set. O(1).
503      *
504      * Returns true if the value was added to the set, that is if it was not
505      * already present.
506      */
507     function add(UintSet storage set, uint256 value) internal returns (bool) {
508         return _add(set._inner, bytes32(value));
509     }
510 
511     /**
512      * @dev Removes a value from a set. O(1).
513      *
514      * Returns true if the value was removed from the set, that is if it was
515      * present.
516      */
517     function remove(UintSet storage set, uint256 value) internal returns (bool) {
518         return _remove(set._inner, bytes32(value));
519     }
520 
521     /**
522      * @dev Returns true if the value is in the set. O(1).
523      */
524     function contains(UintSet storage set, uint256 value) internal view returns (bool) {
525         return _contains(set._inner, bytes32(value));
526     }
527 
528     /**
529      * @dev Returns the number of values in the set. O(1).
530      */
531     function length(UintSet storage set) internal view returns (uint256) {
532         return _length(set._inner);
533     }
534 
535     /**
536      * @dev Returns the value stored at position `index` in the set. O(1).
537      *
538      * Note that there are no guarantees on the ordering of values inside the
539      * array, and it may change when more values are added or removed.
540      *
541      * Requirements:
542      *
543      * - `index` must be strictly less than {length}.
544      */
545     function at(UintSet storage set, uint256 index) internal view returns (uint256) {
546         return uint256(_at(set._inner, index));
547     }
548 
549     /**
550      * @dev Return the entire set in an array
551      *
552      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
553      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
554      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
555      * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.
556      */
557     function values(UintSet storage set) internal view returns (uint256[] memory) {
558         bytes32[] memory store = _values(set._inner);
559         uint256[] memory result;
560 
561         /// @solidity memory-safe-assembly
562         assembly {
563             result := store
564         }
565 
566         return result;
567     }
568 }
569 
570 
571 // File @openzeppelin/contracts/utils/structs/EnumerableMap.sol@v4.9.1
572 
573 // 
574 // OpenZeppelin Contracts (last updated v4.9.0) (utils/structs/EnumerableMap.sol)
575 // This file was procedurally generated from scripts/generate/templates/EnumerableMap.js.
576 
577 pragma solidity ^0.8.0;
578 
579 /**
580  * @dev Library for managing an enumerable variant of Solidity's
581  * https://solidity.readthedocs.io/en/latest/types.html#mapping-types[`mapping`]
582  * type.
583  *
584  * Maps have the following properties:
585  *
586  * - Entries are added, removed, and checked for existence in constant time
587  * (O(1)).
588  * - Entries are enumerated in O(n). No guarantees are made on the ordering.
589  *
590  * ```solidity
591  * contract Example {
592  *     // Add the library methods
593  *     using EnumerableMap for EnumerableMap.UintToAddressMap;
594  *
595  *     // Declare a set state variable
596  *     EnumerableMap.UintToAddressMap private myMap;
597  * }
598  * ```
599  *
600  * The following map types are supported:
601  *
602  * - `uint256 -> address` (`UintToAddressMap`) since v3.0.0
603  * - `address -> uint256` (`AddressToUintMap`) since v4.6.0
604  * - `bytes32 -> bytes32` (`Bytes32ToBytes32Map`) since v4.6.0
605  * - `uint256 -> uint256` (`UintToUintMap`) since v4.7.0
606  * - `bytes32 -> uint256` (`Bytes32ToUintMap`) since v4.7.0
607  *
608  * [WARNING]
609  * ====
610  * Trying to delete such a structure from storage will likely result in data corruption, rendering the structure
611  * unusable.
612  * See https://github.com/ethereum/solidity/pull/11843[ethereum/solidity#11843] for more info.
613  *
614  * In order to clean an EnumerableMap, you can either remove all elements one by one or create a fresh instance using an
615  * array of EnumerableMap.
616  * ====
617  */
618 library EnumerableMap {
619     using EnumerableSet for EnumerableSet.Bytes32Set;
620 
621     // To implement this library for multiple types with as little code
622     // repetition as possible, we write it in terms of a generic Map type with
623     // bytes32 keys and values.
624     // The Map implementation uses private functions, and user-facing
625     // implementations (such as Uint256ToAddressMap) are just wrappers around
626     // the underlying Map.
627     // This means that we can only create new EnumerableMaps for types that fit
628     // in bytes32.
629 
630     struct Bytes32ToBytes32Map {
631         // Storage of keys
632         EnumerableSet.Bytes32Set _keys;
633         mapping(bytes32 => bytes32) _values;
634     }
635 
636     /**
637      * @dev Adds a key-value pair to a map, or updates the value for an existing
638      * key. O(1).
639      *
640      * Returns true if the key was added to the map, that is if it was not
641      * already present.
642      */
643     function set(Bytes32ToBytes32Map storage map, bytes32 key, bytes32 value) internal returns (bool) {
644         map._values[key] = value;
645         return map._keys.add(key);
646     }
647 
648     /**
649      * @dev Removes a key-value pair from a map. O(1).
650      *
651      * Returns true if the key was removed from the map, that is if it was present.
652      */
653     function remove(Bytes32ToBytes32Map storage map, bytes32 key) internal returns (bool) {
654         delete map._values[key];
655         return map._keys.remove(key);
656     }
657 
658     /**
659      * @dev Returns true if the key is in the map. O(1).
660      */
661     function contains(Bytes32ToBytes32Map storage map, bytes32 key) internal view returns (bool) {
662         return map._keys.contains(key);
663     }
664 
665     /**
666      * @dev Returns the number of key-value pairs in the map. O(1).
667      */
668     function length(Bytes32ToBytes32Map storage map) internal view returns (uint256) {
669         return map._keys.length();
670     }
671 
672     /**
673      * @dev Returns the key-value pair stored at position `index` in the map. O(1).
674      *
675      * Note that there are no guarantees on the ordering of entries inside the
676      * array, and it may change when more entries are added or removed.
677      *
678      * Requirements:
679      *
680      * - `index` must be strictly less than {length}.
681      */
682     function at(Bytes32ToBytes32Map storage map, uint256 index) internal view returns (bytes32, bytes32) {
683         bytes32 key = map._keys.at(index);
684         return (key, map._values[key]);
685     }
686 
687     /**
688      * @dev Tries to returns the value associated with `key`. O(1).
689      * Does not revert if `key` is not in the map.
690      */
691     function tryGet(Bytes32ToBytes32Map storage map, bytes32 key) internal view returns (bool, bytes32) {
692         bytes32 value = map._values[key];
693         if (value == bytes32(0)) {
694             return (contains(map, key), bytes32(0));
695         } else {
696             return (true, value);
697         }
698     }
699 
700     /**
701      * @dev Returns the value associated with `key`. O(1).
702      *
703      * Requirements:
704      *
705      * - `key` must be in the map.
706      */
707     function get(Bytes32ToBytes32Map storage map, bytes32 key) internal view returns (bytes32) {
708         bytes32 value = map._values[key];
709         require(value != 0 || contains(map, key), "EnumerableMap: nonexistent key");
710         return value;
711     }
712 
713     /**
714      * @dev Same as {get}, with a custom error message when `key` is not in the map.
715      *
716      * CAUTION: This function is deprecated because it requires allocating memory for the error
717      * message unnecessarily. For custom revert reasons use {tryGet}.
718      */
719     function get(
720         Bytes32ToBytes32Map storage map,
721         bytes32 key,
722         string memory errorMessage
723     ) internal view returns (bytes32) {
724         bytes32 value = map._values[key];
725         require(value != 0 || contains(map, key), errorMessage);
726         return value;
727     }
728 
729     /**
730      * @dev Return the an array containing all the keys
731      *
732      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
733      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
734      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
735      * uncallable if the map grows to a point where copying to memory consumes too much gas to fit in a block.
736      */
737     function keys(Bytes32ToBytes32Map storage map) internal view returns (bytes32[] memory) {
738         return map._keys.values();
739     }
740 
741     // UintToUintMap
742 
743     struct UintToUintMap {
744         Bytes32ToBytes32Map _inner;
745     }
746 
747     /**
748      * @dev Adds a key-value pair to a map, or updates the value for an existing
749      * key. O(1).
750      *
751      * Returns true if the key was added to the map, that is if it was not
752      * already present.
753      */
754     function set(UintToUintMap storage map, uint256 key, uint256 value) internal returns (bool) {
755         return set(map._inner, bytes32(key), bytes32(value));
756     }
757 
758     /**
759      * @dev Removes a value from a map. O(1).
760      *
761      * Returns true if the key was removed from the map, that is if it was present.
762      */
763     function remove(UintToUintMap storage map, uint256 key) internal returns (bool) {
764         return remove(map._inner, bytes32(key));
765     }
766 
767     /**
768      * @dev Returns true if the key is in the map. O(1).
769      */
770     function contains(UintToUintMap storage map, uint256 key) internal view returns (bool) {
771         return contains(map._inner, bytes32(key));
772     }
773 
774     /**
775      * @dev Returns the number of elements in the map. O(1).
776      */
777     function length(UintToUintMap storage map) internal view returns (uint256) {
778         return length(map._inner);
779     }
780 
781     /**
782      * @dev Returns the element stored at position `index` in the map. O(1).
783      * Note that there are no guarantees on the ordering of values inside the
784      * array, and it may change when more values are added or removed.
785      *
786      * Requirements:
787      *
788      * - `index` must be strictly less than {length}.
789      */
790     function at(UintToUintMap storage map, uint256 index) internal view returns (uint256, uint256) {
791         (bytes32 key, bytes32 value) = at(map._inner, index);
792         return (uint256(key), uint256(value));
793     }
794 
795     /**
796      * @dev Tries to returns the value associated with `key`. O(1).
797      * Does not revert if `key` is not in the map.
798      */
799     function tryGet(UintToUintMap storage map, uint256 key) internal view returns (bool, uint256) {
800         (bool success, bytes32 value) = tryGet(map._inner, bytes32(key));
801         return (success, uint256(value));
802     }
803 
804     /**
805      * @dev Returns the value associated with `key`. O(1).
806      *
807      * Requirements:
808      *
809      * - `key` must be in the map.
810      */
811     function get(UintToUintMap storage map, uint256 key) internal view returns (uint256) {
812         return uint256(get(map._inner, bytes32(key)));
813     }
814 
815     /**
816      * @dev Same as {get}, with a custom error message when `key` is not in the map.
817      *
818      * CAUTION: This function is deprecated because it requires allocating memory for the error
819      * message unnecessarily. For custom revert reasons use {tryGet}.
820      */
821     function get(UintToUintMap storage map, uint256 key, string memory errorMessage) internal view returns (uint256) {
822         return uint256(get(map._inner, bytes32(key), errorMessage));
823     }
824 
825     /**
826      * @dev Return the an array containing all the keys
827      *
828      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
829      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
830      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
831      * uncallable if the map grows to a point where copying to memory consumes too much gas to fit in a block.
832      */
833     function keys(UintToUintMap storage map) internal view returns (uint256[] memory) {
834         bytes32[] memory store = keys(map._inner);
835         uint256[] memory result;
836 
837         /// @solidity memory-safe-assembly
838         assembly {
839             result := store
840         }
841 
842         return result;
843     }
844 
845     // UintToAddressMap
846 
847     struct UintToAddressMap {
848         Bytes32ToBytes32Map _inner;
849     }
850 
851     /**
852      * @dev Adds a key-value pair to a map, or updates the value for an existing
853      * key. O(1).
854      *
855      * Returns true if the key was added to the map, that is if it was not
856      * already present.
857      */
858     function set(UintToAddressMap storage map, uint256 key, address value) internal returns (bool) {
859         return set(map._inner, bytes32(key), bytes32(uint256(uint160(value))));
860     }
861 
862     /**
863      * @dev Removes a value from a map. O(1).
864      *
865      * Returns true if the key was removed from the map, that is if it was present.
866      */
867     function remove(UintToAddressMap storage map, uint256 key) internal returns (bool) {
868         return remove(map._inner, bytes32(key));
869     }
870 
871     /**
872      * @dev Returns true if the key is in the map. O(1).
873      */
874     function contains(UintToAddressMap storage map, uint256 key) internal view returns (bool) {
875         return contains(map._inner, bytes32(key));
876     }
877 
878     /**
879      * @dev Returns the number of elements in the map. O(1).
880      */
881     function length(UintToAddressMap storage map) internal view returns (uint256) {
882         return length(map._inner);
883     }
884 
885     /**
886      * @dev Returns the element stored at position `index` in the map. O(1).
887      * Note that there are no guarantees on the ordering of values inside the
888      * array, and it may change when more values are added or removed.
889      *
890      * Requirements:
891      *
892      * - `index` must be strictly less than {length}.
893      */
894     function at(UintToAddressMap storage map, uint256 index) internal view returns (uint256, address) {
895         (bytes32 key, bytes32 value) = at(map._inner, index);
896         return (uint256(key), address(uint160(uint256(value))));
897     }
898 
899     /**
900      * @dev Tries to returns the value associated with `key`. O(1).
901      * Does not revert if `key` is not in the map.
902      */
903     function tryGet(UintToAddressMap storage map, uint256 key) internal view returns (bool, address) {
904         (bool success, bytes32 value) = tryGet(map._inner, bytes32(key));
905         return (success, address(uint160(uint256(value))));
906     }
907 
908     /**
909      * @dev Returns the value associated with `key`. O(1).
910      *
911      * Requirements:
912      *
913      * - `key` must be in the map.
914      */
915     function get(UintToAddressMap storage map, uint256 key) internal view returns (address) {
916         return address(uint160(uint256(get(map._inner, bytes32(key)))));
917     }
918 
919     /**
920      * @dev Same as {get}, with a custom error message when `key` is not in the map.
921      *
922      * CAUTION: This function is deprecated because it requires allocating memory for the error
923      * message unnecessarily. For custom revert reasons use {tryGet}.
924      */
925     function get(
926         UintToAddressMap storage map,
927         uint256 key,
928         string memory errorMessage
929     ) internal view returns (address) {
930         return address(uint160(uint256(get(map._inner, bytes32(key), errorMessage))));
931     }
932 
933     /**
934      * @dev Return the an array containing all the keys
935      *
936      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
937      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
938      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
939      * uncallable if the map grows to a point where copying to memory consumes too much gas to fit in a block.
940      */
941     function keys(UintToAddressMap storage map) internal view returns (uint256[] memory) {
942         bytes32[] memory store = keys(map._inner);
943         uint256[] memory result;
944 
945         /// @solidity memory-safe-assembly
946         assembly {
947             result := store
948         }
949 
950         return result;
951     }
952 
953     // AddressToUintMap
954 
955     struct AddressToUintMap {
956         Bytes32ToBytes32Map _inner;
957     }
958 
959     /**
960      * @dev Adds a key-value pair to a map, or updates the value for an existing
961      * key. O(1).
962      *
963      * Returns true if the key was added to the map, that is if it was not
964      * already present.
965      */
966     function set(AddressToUintMap storage map, address key, uint256 value) internal returns (bool) {
967         return set(map._inner, bytes32(uint256(uint160(key))), bytes32(value));
968     }
969 
970     /**
971      * @dev Removes a value from a map. O(1).
972      *
973      * Returns true if the key was removed from the map, that is if it was present.
974      */
975     function remove(AddressToUintMap storage map, address key) internal returns (bool) {
976         return remove(map._inner, bytes32(uint256(uint160(key))));
977     }
978 
979     /**
980      * @dev Returns true if the key is in the map. O(1).
981      */
982     function contains(AddressToUintMap storage map, address key) internal view returns (bool) {
983         return contains(map._inner, bytes32(uint256(uint160(key))));
984     }
985 
986     /**
987      * @dev Returns the number of elements in the map. O(1).
988      */
989     function length(AddressToUintMap storage map) internal view returns (uint256) {
990         return length(map._inner);
991     }
992 
993     /**
994      * @dev Returns the element stored at position `index` in the map. O(1).
995      * Note that there are no guarantees on the ordering of values inside the
996      * array, and it may change when more values are added or removed.
997      *
998      * Requirements:
999      *
1000      * - `index` must be strictly less than {length}.
1001      */
1002     function at(AddressToUintMap storage map, uint256 index) internal view returns (address, uint256) {
1003         (bytes32 key, bytes32 value) = at(map._inner, index);
1004         return (address(uint160(uint256(key))), uint256(value));
1005     }
1006 
1007     /**
1008      * @dev Tries to returns the value associated with `key`. O(1).
1009      * Does not revert if `key` is not in the map.
1010      */
1011     function tryGet(AddressToUintMap storage map, address key) internal view returns (bool, uint256) {
1012         (bool success, bytes32 value) = tryGet(map._inner, bytes32(uint256(uint160(key))));
1013         return (success, uint256(value));
1014     }
1015 
1016     /**
1017      * @dev Returns the value associated with `key`. O(1).
1018      *
1019      * Requirements:
1020      *
1021      * - `key` must be in the map.
1022      */
1023     function get(AddressToUintMap storage map, address key) internal view returns (uint256) {
1024         return uint256(get(map._inner, bytes32(uint256(uint160(key)))));
1025     }
1026 
1027     /**
1028      * @dev Same as {get}, with a custom error message when `key` is not in the map.
1029      *
1030      * CAUTION: This function is deprecated because it requires allocating memory for the error
1031      * message unnecessarily. For custom revert reasons use {tryGet}.
1032      */
1033     function get(
1034         AddressToUintMap storage map,
1035         address key,
1036         string memory errorMessage
1037     ) internal view returns (uint256) {
1038         return uint256(get(map._inner, bytes32(uint256(uint160(key))), errorMessage));
1039     }
1040 
1041     /**
1042      * @dev Return the an array containing all the keys
1043      *
1044      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
1045      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
1046      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
1047      * uncallable if the map grows to a point where copying to memory consumes too much gas to fit in a block.
1048      */
1049     function keys(AddressToUintMap storage map) internal view returns (address[] memory) {
1050         bytes32[] memory store = keys(map._inner);
1051         address[] memory result;
1052 
1053         /// @solidity memory-safe-assembly
1054         assembly {
1055             result := store
1056         }
1057 
1058         return result;
1059     }
1060 
1061     // Bytes32ToUintMap
1062 
1063     struct Bytes32ToUintMap {
1064         Bytes32ToBytes32Map _inner;
1065     }
1066 
1067     /**
1068      * @dev Adds a key-value pair to a map, or updates the value for an existing
1069      * key. O(1).
1070      *
1071      * Returns true if the key was added to the map, that is if it was not
1072      * already present.
1073      */
1074     function set(Bytes32ToUintMap storage map, bytes32 key, uint256 value) internal returns (bool) {
1075         return set(map._inner, key, bytes32(value));
1076     }
1077 
1078     /**
1079      * @dev Removes a value from a map. O(1).
1080      *
1081      * Returns true if the key was removed from the map, that is if it was present.
1082      */
1083     function remove(Bytes32ToUintMap storage map, bytes32 key) internal returns (bool) {
1084         return remove(map._inner, key);
1085     }
1086 
1087     /**
1088      * @dev Returns true if the key is in the map. O(1).
1089      */
1090     function contains(Bytes32ToUintMap storage map, bytes32 key) internal view returns (bool) {
1091         return contains(map._inner, key);
1092     }
1093 
1094     /**
1095      * @dev Returns the number of elements in the map. O(1).
1096      */
1097     function length(Bytes32ToUintMap storage map) internal view returns (uint256) {
1098         return length(map._inner);
1099     }
1100 
1101     /**
1102      * @dev Returns the element stored at position `index` in the map. O(1).
1103      * Note that there are no guarantees on the ordering of values inside the
1104      * array, and it may change when more values are added or removed.
1105      *
1106      * Requirements:
1107      *
1108      * - `index` must be strictly less than {length}.
1109      */
1110     function at(Bytes32ToUintMap storage map, uint256 index) internal view returns (bytes32, uint256) {
1111         (bytes32 key, bytes32 value) = at(map._inner, index);
1112         return (key, uint256(value));
1113     }
1114 
1115     /**
1116      * @dev Tries to returns the value associated with `key`. O(1).
1117      * Does not revert if `key` is not in the map.
1118      */
1119     function tryGet(Bytes32ToUintMap storage map, bytes32 key) internal view returns (bool, uint256) {
1120         (bool success, bytes32 value) = tryGet(map._inner, key);
1121         return (success, uint256(value));
1122     }
1123 
1124     /**
1125      * @dev Returns the value associated with `key`. O(1).
1126      *
1127      * Requirements:
1128      *
1129      * - `key` must be in the map.
1130      */
1131     function get(Bytes32ToUintMap storage map, bytes32 key) internal view returns (uint256) {
1132         return uint256(get(map._inner, key));
1133     }
1134 
1135     /**
1136      * @dev Same as {get}, with a custom error message when `key` is not in the map.
1137      *
1138      * CAUTION: This function is deprecated because it requires allocating memory for the error
1139      * message unnecessarily. For custom revert reasons use {tryGet}.
1140      */
1141     function get(
1142         Bytes32ToUintMap storage map,
1143         bytes32 key,
1144         string memory errorMessage
1145     ) internal view returns (uint256) {
1146         return uint256(get(map._inner, key, errorMessage));
1147     }
1148 
1149     /**
1150      * @dev Return the an array containing all the keys
1151      *
1152      * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed
1153      * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that
1154      * this function has an unbounded cost, and using it as part of a state-changing function may render the function
1155      * uncallable if the map grows to a point where copying to memory consumes too much gas to fit in a block.
1156      */
1157     function keys(Bytes32ToUintMap storage map) internal view returns (bytes32[] memory) {
1158         bytes32[] memory store = keys(map._inner);
1159         bytes32[] memory result;
1160 
1161         /// @solidity memory-safe-assembly
1162         assembly {
1163             result := store
1164         }
1165 
1166         return result;
1167     }
1168 }
1169 
1170 
1171 // File @uniswap/v2-periphery/contracts/interfaces/IUniswapV2Router01.sol@v1.1.0-beta.0
1172 
1173 pragma solidity >=0.6.2;
1174 
1175 interface IUniswapV2Router01 {
1176     function factory() external pure returns (address);
1177     function WETH() external pure returns (address);
1178 
1179     function addLiquidity(
1180         address tokenA,
1181         address tokenB,
1182         uint amountADesired,
1183         uint amountBDesired,
1184         uint amountAMin,
1185         uint amountBMin,
1186         address to,
1187         uint deadline
1188     ) external returns (uint amountA, uint amountB, uint liquidity);
1189     function addLiquidityETH(
1190         address token,
1191         uint amountTokenDesired,
1192         uint amountTokenMin,
1193         uint amountETHMin,
1194         address to,
1195         uint deadline
1196     ) external payable returns (uint amountToken, uint amountETH, uint liquidity);
1197     function removeLiquidity(
1198         address tokenA,
1199         address tokenB,
1200         uint liquidity,
1201         uint amountAMin,
1202         uint amountBMin,
1203         address to,
1204         uint deadline
1205     ) external returns (uint amountA, uint amountB);
1206     function removeLiquidityETH(
1207         address token,
1208         uint liquidity,
1209         uint amountTokenMin,
1210         uint amountETHMin,
1211         address to,
1212         uint deadline
1213     ) external returns (uint amountToken, uint amountETH);
1214     function removeLiquidityWithPermit(
1215         address tokenA,
1216         address tokenB,
1217         uint liquidity,
1218         uint amountAMin,
1219         uint amountBMin,
1220         address to,
1221         uint deadline,
1222         bool approveMax, uint8 v, bytes32 r, bytes32 s
1223     ) external returns (uint amountA, uint amountB);
1224     function removeLiquidityETHWithPermit(
1225         address token,
1226         uint liquidity,
1227         uint amountTokenMin,
1228         uint amountETHMin,
1229         address to,
1230         uint deadline,
1231         bool approveMax, uint8 v, bytes32 r, bytes32 s
1232     ) external returns (uint amountToken, uint amountETH);
1233     function swapExactTokensForTokens(
1234         uint amountIn,
1235         uint amountOutMin,
1236         address[] calldata path,
1237         address to,
1238         uint deadline
1239     ) external returns (uint[] memory amounts);
1240     function swapTokensForExactTokens(
1241         uint amountOut,
1242         uint amountInMax,
1243         address[] calldata path,
1244         address to,
1245         uint deadline
1246     ) external returns (uint[] memory amounts);
1247     function swapExactETHForTokens(uint amountOutMin, address[] calldata path, address to, uint deadline)
1248         external
1249         payable
1250         returns (uint[] memory amounts);
1251     function swapTokensForExactETH(uint amountOut, uint amountInMax, address[] calldata path, address to, uint deadline)
1252         external
1253         returns (uint[] memory amounts);
1254     function swapExactTokensForETH(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline)
1255         external
1256         returns (uint[] memory amounts);
1257     function swapETHForExactTokens(uint amountOut, address[] calldata path, address to, uint deadline)
1258         external
1259         payable
1260         returns (uint[] memory amounts);
1261 
1262     function quote(uint amountA, uint reserveA, uint reserveB) external pure returns (uint amountB);
1263     function getAmountOut(uint amountIn, uint reserveIn, uint reserveOut) external pure returns (uint amountOut);
1264     function getAmountIn(uint amountOut, uint reserveIn, uint reserveOut) external pure returns (uint amountIn);
1265     function getAmountsOut(uint amountIn, address[] calldata path) external view returns (uint[] memory amounts);
1266     function getAmountsIn(uint amountOut, address[] calldata path) external view returns (uint[] memory amounts);
1267 }
1268 
1269 
1270 // File @uniswap/v2-periphery/contracts/interfaces/IUniswapV2Router02.sol@v1.1.0-beta.0
1271 
1272 pragma solidity >=0.6.2;
1273 
1274 interface IUniswapV2Router02 is IUniswapV2Router01 {
1275     function removeLiquidityETHSupportingFeeOnTransferTokens(
1276         address token,
1277         uint liquidity,
1278         uint amountTokenMin,
1279         uint amountETHMin,
1280         address to,
1281         uint deadline
1282     ) external returns (uint amountETH);
1283     function removeLiquidityETHWithPermitSupportingFeeOnTransferTokens(
1284         address token,
1285         uint liquidity,
1286         uint amountTokenMin,
1287         uint amountETHMin,
1288         address to,
1289         uint deadline,
1290         bool approveMax, uint8 v, bytes32 r, bytes32 s
1291     ) external returns (uint amountETH);
1292 
1293     function swapExactTokensForTokensSupportingFeeOnTransferTokens(
1294         uint amountIn,
1295         uint amountOutMin,
1296         address[] calldata path,
1297         address to,
1298         uint deadline
1299     ) external;
1300     function swapExactETHForTokensSupportingFeeOnTransferTokens(
1301         uint amountOutMin,
1302         address[] calldata path,
1303         address to,
1304         uint deadline
1305     ) external payable;
1306     function swapExactTokensForETHSupportingFeeOnTransferTokens(
1307         uint amountIn,
1308         uint amountOutMin,
1309         address[] calldata path,
1310         address to,
1311         uint deadline
1312     ) external;
1313 }
1314 
1315 
1316 // File @openzeppelin/contracts/utils/Context.sol@v4.9.1
1317 
1318 // 
1319 // OpenZeppelin Contracts v4.4.1 (utils/Context.sol)
1320 
1321 pragma solidity ^0.8.0;
1322 
1323 /**
1324  * @dev Provides information about the current execution context, including the
1325  * sender of the transaction and its data. While these are generally available
1326  * via msg.sender and msg.data, they should not be accessed in such a direct
1327  * manner, since when dealing with meta-transactions the account sending and
1328  * paying for execution may not be the actual sender (as far as an application
1329  * is concerned).
1330  *
1331  * This contract is only required for intermediate, library-like contracts.
1332  */
1333 abstract contract Context {
1334     function _msgSender() internal view virtual returns (address) {
1335         return msg.sender;
1336     }
1337 
1338     function _msgData() internal view virtual returns (bytes calldata) {
1339         return msg.data;
1340     }
1341 }
1342 
1343 
1344 // File @uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol@v1.0.0
1345 
1346 pragma solidity >=0.5.0;
1347 
1348 interface IUniswapV2Factory {
1349     event PairCreated(address indexed token0, address indexed token1, address pair, uint);
1350 
1351     function feeTo() external view returns (address);
1352     function feeToSetter() external view returns (address);
1353 
1354     function getPair(address tokenA, address tokenB) external view returns (address pair);
1355     function allPairs(uint) external view returns (address pair);
1356     function allPairsLength() external view returns (uint);
1357 
1358     function createPair(address tokenA, address tokenB) external returns (address pair);
1359 
1360     function setFeeTo(address) external;
1361     function setFeeToSetter(address) external;
1362 }
1363 
1364 
1365 // File contracts/ERC20FactoryV1/ERC20/IERC20ConfigByMetadropV1.sol
1366 
1367 // 
1368 // Metadrop Contracts (v2.1.0)
1369 
1370 /**
1371  *
1372  * @title IERC20ByMetadrop.sol. Interface for metadrop ERC20 standard
1373  *
1374  * @author metadrop https://metadrop.com/
1375  *
1376  */
1377 
1378 pragma solidity 0.8.19;
1379 
1380 interface IERC20ConfigByMetadropV1 {
1381   struct ERC20Config {
1382     bytes baseParameters;
1383     bytes supplyParameters;
1384     bytes taxParameters;
1385   }
1386 
1387   struct ERC20BaseParameters {
1388     string name;
1389     string symbol;
1390     string website;
1391     string twitter;
1392     string telegram;
1393     string otherSocials;
1394   }
1395 
1396   struct ERC20SupplyParameters {
1397     uint256 maxSupply;
1398     uint256 lpSupply;
1399     uint256 projectSupply;
1400     uint256 maxTokensPerWallet;
1401     uint256 maxTokensPerTxn;
1402     uint256 lpLockupInDays;
1403     bool addLiquidityOnCreate;
1404     address projectTreasury;
1405     address metadropTreasury;
1406   }
1407 
1408   struct ERC20TaxParameters {
1409     uint256 projectBuyTaxBasisPoints;
1410     uint256 projectSellTaxBasisPoints;
1411     uint256 maxProjectBuyTaxBasisPoints;
1412     uint256 maxProjectSellTaxBasisPoints;
1413     uint256 taxSwapThresholdBasisPoints;
1414     uint256 metadropBuyTaxBasisPoints;
1415     uint256 metadropSellTaxBasisPoints;
1416     uint256 maxMetadropBuyTaxBasisPoints;
1417     uint256 maxMetadropSellTaxBasisPoints;
1418     uint256 metadropTaxPeriodInDays;
1419   }
1420 }
1421 
1422 
1423 // File contracts/Global/IConfigStructures.sol
1424 
1425 // 
1426 // Metadrop Contracts (v2.1.0)
1427 
1428 /**
1429  *
1430  * @title IConfigStructures.sol. Interface for common config structures used accross the platform
1431  *
1432  * @author metadrop https://metadrop.com/
1433  *
1434  */
1435 
1436 pragma solidity 0.8.19;
1437 
1438 interface IConfigStructures {
1439   enum DropStatus {
1440     approved,
1441     deployed,
1442     cancelled
1443   }
1444 
1445   enum TemplateStatus {
1446     live,
1447     terminated
1448   }
1449 
1450   // The current status of the mint:
1451   //   - notEnabled: This type of mint is not part of this drop
1452   //   - notYetOpen: This type of mint is part of the drop, but it hasn't started yet
1453   //   - open: it's ready for ya, get in there.
1454   //   - finished: been and gone.
1455   //   - unknown: theoretically impossible.
1456   enum MintStatus {
1457     notEnabled,
1458     notYetOpen,
1459     open,
1460     finished,
1461     unknown
1462   }
1463 
1464   struct SubListConfig {
1465     uint256 start;
1466     uint256 end;
1467     uint256 phaseMaxSupply;
1468   }
1469 
1470   struct PrimarySaleModuleInstance {
1471     address instanceAddress;
1472     string instanceDescription;
1473   }
1474 
1475   struct NFTModuleConfig {
1476     uint256 templateId;
1477     bytes configData;
1478     bytes vestingData;
1479   }
1480 
1481   struct PrimarySaleModuleConfig {
1482     uint256 templateId;
1483     bytes configData;
1484   }
1485 
1486   struct ProjectBeneficiary {
1487     address payable payeeAddress;
1488     uint256 payeeShares;
1489   }
1490 
1491   struct VestingConfig {
1492     uint256 start;
1493     uint256 projectUpFrontShare;
1494     uint256 projectVestedShare;
1495     uint256 vestingPeriodInDays;
1496     uint256 vestingCliff;
1497     ProjectBeneficiary[] projectPayees;
1498   }
1499 
1500   struct RoyaltySplitterModuleConfig {
1501     uint256 templateId;
1502     bytes configData;
1503   }
1504 
1505   struct InLifeModuleConfig {
1506     uint256 templateId;
1507     bytes configData;
1508   }
1509 
1510   struct InLifeModules {
1511     InLifeModuleConfig[] modules;
1512   }
1513 
1514   struct NFTConfig {
1515     uint256 supply;
1516     string name;
1517     string symbol;
1518     bytes32 positionProof;
1519     bool includePriorPhasesInMintTracking;
1520     bool singleMetadataCollection;
1521     uint256 reservedAllocation;
1522     uint256 assistanceRequestWindowInSeconds;
1523   }
1524 
1525   struct Template {
1526     TemplateStatus status;
1527     uint16 templateNumber;
1528     uint32 loadedDate;
1529     address payable templateAddress;
1530     string templateDescription;
1531   }
1532 
1533   struct RoyaltyDetails {
1534     address newRoyaltyPaymentSplitterInstance;
1535     uint96 royaltyFromSalesInBasisPoints;
1536   }
1537 
1538   struct SignedDropMessageDetails {
1539     uint256 messageTimeStamp;
1540     bytes32 messageHash;
1541     bytes messageSignature;
1542   }
1543 }
1544 
1545 
1546 // File contracts/ERC20FactoryV1/ERC20/IERC20ByMetadropV1.sol
1547 
1548 // 
1549 // Metadrop Contracts (v2.1.0)
1550 
1551 pragma solidity 0.8.19;
1552 
1553 
1554 
1555 
1556 /**
1557  * @dev Metadrop core ERC-20 contract, interface
1558  */
1559 interface IERC20ByMetadropV1 is
1560   IERC20,
1561   IERC20ConfigByMetadropV1,
1562   IERC20Metadata,
1563   IConfigStructures
1564 {
1565   struct SocialLinks {
1566     string linkType;
1567     string link;
1568   }
1569 
1570   event AutoSwapThresholdUpdated(uint256 oldThreshold, uint256 newThreshold);
1571 
1572   event ProjectTaxBasisPointsChanged(
1573     uint256 oldBuyBasisPoints,
1574     uint256 newBuyBasisPoints,
1575     uint256 oldSellBasisPoints,
1576     uint256 newSellBasisPoints
1577   );
1578 
1579   event MetadropTaxBasisPointsChanged(
1580     uint256 oldBuyBasisPoints,
1581     uint256 newBuyBasisPoints,
1582     uint256 oldSellBasisPoints,
1583     uint256 newSellBasisPoints
1584   );
1585 
1586   event LiquidityPoolCreated(address addedPool);
1587 
1588   event LiquidityPoolAdded(address addedPool);
1589 
1590   event LiquidityPoolRemoved(address removedPool);
1591 
1592   event InitialLiquidityAdded(uint256 tokenA, uint256 tokenB, uint256 lpToken);
1593 
1594   event LiquidityLocked();
1595 
1596   event RevenueAutoSwap();
1597 
1598   event SetLimitsEnabled(bool enabled);
1599 
1600   event TreasuryUpdated(address treasury);
1601 
1602   event UnlimitedAddressAdded(address addedUnlimted);
1603 
1604   event UnlimitedAddressRemoved(address removedUnlimted);
1605 
1606   /**
1607    * @dev function {addInitialLiquidity}
1608    *
1609    * Add initial liquidity to the uniswap pair
1610    *
1611    * @param lockerFee_ The locker fee in wei. This must match the required fee from the external locker contract.
1612    */
1613   function addInitialLiquidity(uint256 lockerFee_) external payable;
1614 
1615   /**
1616    * @dev function {isLiquidityPool}
1617    *
1618    * Return if an address is a liquidity pool
1619    *
1620    * @param queryAddress_ The address being queried
1621    * @return bool The address is / isn't a liquidity pool
1622    */
1623   function isLiquidityPool(address queryAddress_) external view returns (bool);
1624 
1625   /**
1626    * @dev function {addLiquidityPool} onlyTaxAdmin
1627    *
1628    * Allows the tax admin to add a liquidity pool to the pool enumerable set
1629    *
1630    * @param newLiquidityPool_ The address of the new liquidity pool
1631    */
1632   function addLiquidityPool(address newLiquidityPool_) external;
1633 
1634   /**
1635    * @dev function {removeLiquidityPool} onlyTaxAdmin
1636    *
1637    * Allows the tax admin to remove a liquidity pool
1638    *
1639    * @param removedLiquidityPool_ The address of the old removed liquidity pool
1640    */
1641   function removeLiquidityPool(address removedLiquidityPool_) external;
1642 
1643   /**
1644    * @dev function {isUnlimited}
1645    *
1646    * Return if an address is unlimited (is not subject to per txn and per wallet limits)
1647    *
1648    * @param queryAddress_ The address being queried
1649    * @return bool The address is / isn't unlimited
1650    */
1651   function isUnlimited(address queryAddress_) external view returns (bool);
1652 
1653   /**
1654    * @dev function {addUnlimited} onlyTaxAdmin
1655    *
1656    * Allows the tax admin to add an unlimited address
1657    *
1658    * @param newUnlimited_ The address of the new unlimited address
1659    */
1660   function addUnlimited(address newUnlimited_) external;
1661 
1662   /**
1663    * @dev function {removeUnlimited} onlyTaxAdmin
1664    *
1665    * Allows the tax admin to remove an unlimited address
1666    *
1667    * @param removedUnlimited_ The address of the old removed unlimited address
1668    */
1669   function removeUnlimited(address removedUnlimited_) external;
1670 
1671   /**
1672    * @dev function {setLimitsEnabledStatus} onlyTaxAdmin
1673    *
1674    * Allows the tax admin to enable / disable tokens per txn and per holder validation.
1675    *
1676    * @param enabled_ Should limits be on?
1677    */
1678   function setLimitsEnabledStatus(bool enabled_) external;
1679 
1680   /**
1681    * @dev function {setProjectTreasury} onlyTaxAdmin
1682    *
1683    * Allows the tax admin to set the treasury address
1684    *
1685    * @param projectTreasury_ New treasury address
1686    */
1687   function setProjectTreasury(address projectTreasury_) external;
1688 
1689   /**
1690    * @dev function {setSwapThresholdBasisPoints} onlyTaxAdmin
1691    *
1692    * Allows the tax admin to set the autoswap threshold
1693    *
1694    * @param swapThresholdBasisPoints_ New swap threshold in basis points
1695    */
1696   function setSwapThresholdBasisPoints(
1697     uint16 swapThresholdBasisPoints_
1698   ) external;
1699 
1700   /**
1701    * @dev function {withdrawETH} onlyOwner
1702    *
1703    * Allows the owner to withdraw ETH
1704    *
1705    * @param amount_ The amount to withdraw
1706    */
1707   function withdrawETH(uint256 amount_) external;
1708 
1709   /**
1710    * @dev function {withdrawERC20} onlyOwner
1711    *
1712    * A withdraw function to allow ERC20s to be withdrawn.
1713    *
1714    * @param token_ The address of the token being withdrawn
1715    * @param amount_ The amount to withdraw
1716    */
1717   function withdrawERC20(IERC20 token_, uint256 amount_) external;
1718 
1719   /**
1720    * @dev function {setProjectTaxRates} onlyTaxAdmin
1721    *
1722    * Change the tax rates, subject to max rate
1723    *
1724    * @param newProjectBuyTaxBasisPoints_ The new buy tax rate
1725    * @param newProjectSellTaxBasisPoints_ The new sell tax rate
1726    */
1727   function setProjectTaxRates(
1728     uint16 newProjectBuyTaxBasisPoints_,
1729     uint16 newProjectSellTaxBasisPoints_
1730   ) external;
1731 
1732   /**
1733    * @dev function {setMetadropTaxRates} onlyTaxAdmin
1734    *
1735    * Change the tax rates, subject to max rate and minimum tax period.
1736    *
1737    * @param newMetadropBuyTaxBasisPoints_ The new buy tax rate
1738    * @param newMetadropSellTaxBasisPoints_ The new sell tax rate
1739    */
1740   function setMetadropTaxRates(
1741     uint16 newMetadropBuyTaxBasisPoints_,
1742     uint16 newMetadropSellTaxBasisPoints_
1743   ) external;
1744 }
1745 
1746 
1747 // File contracts/Global/IErrors.sol
1748 
1749 // 
1750 // Metadrop Contracts (v2.1.0)
1751 
1752 /**
1753  *
1754  * @title IErrors.sol. Interface for error definitions used across the platform
1755  *
1756  * @author metadrop https://metadrop.com/
1757  *
1758  */
1759 
1760 pragma solidity 0.8.19;
1761 
1762 interface IErrors {
1763   enum BondingCurveErrorType {
1764     OK, //                                                  No error
1765     INVALID_NUMITEMS, //                                    The numItem value is 0
1766     SPOT_PRICE_OVERFLOW //                                  The updated spot price doesn't fit into 128 bits
1767   }
1768 
1769   error AdapterParamsMustBeEmpty(); //                      The adapter parameters on this LZ call must be empty.
1770 
1771   error AddressAlreadySet(); //                             The address being set can only be set once, and is already non-0.
1772 
1773   error AllowanceDecreasedBelowZero(); //                   You cannot decrease the allowance below zero.
1774 
1775   error AlreadyInitialised(); //                            The contract is already initialised: it cannot be initialised twice!
1776 
1777   error ApprovalCallerNotOwnerNorApproved(); //             The caller must own the token or be an approved operator.
1778 
1779   error ApproveFromTheZeroAddress(); //                     Approval cannot be called from the zero address (indeed, how have you??).
1780 
1781   error ApproveToTheZeroAddress(); //                       Approval cannot be given to the zero address.
1782 
1783   error ApprovalQueryForNonexistentToken(); //              The token does not exist.
1784 
1785   error AuctionStatusIsNotEnded(); //                       Throw if the action required the auction to be closed, and it isn't.
1786 
1787   error AuctionStatusIsNotOpen(); //                        Throw if the action requires the auction to be open, and it isn't.
1788 
1789   error AuxCallFailed(
1790     address[] modules,
1791     uint256 value,
1792     bytes data,
1793     uint256 txGas
1794   ); //                                                     An auxilliary call from the drop factory failed.
1795 
1796   error BalanceQueryForZeroAddress(); //                    Cannot query the balance for the zero address.
1797 
1798   error BidMustBeBelowTheFloorWhenReducingQuantity(); //    Only bids that are below the floor can reduce the quantity of the bid.
1799 
1800   error BidMustBeBelowTheFloorForRefundDuringAuction(); //  Only bids that are below the floor can be refunded during the auction.
1801 
1802   error BondingCurveError(BondingCurveErrorType error); //  An error of the type specified has occured in bonding curve processing.
1803 
1804   error BurnExceedsBalance(); //                            The amount you have selected to burn exceeds the addresses balance.
1805 
1806   error BurnFromTheZeroAddress(); //                        Tokens cannot be burned from the zero address. (Also, how have you called this!?!)
1807 
1808   error CallerIsNotFactory(); //                            The caller of this function must match the factory address in storage.
1809 
1810   error CallerIsNotFactoryOrProjectOwner(); //              The caller of this function must match the factory address OR project owner address.
1811 
1812   error CallerIsNotTheOwner(); //                           The caller is not the owner of this contract.
1813 
1814   error CallerIsNotTheTaxAdmin(); //                        The caller is not the tax admin of this contract.
1815 
1816   error CallerMustBeLzApp(); //                             The caller must be an LZ application.
1817 
1818   error CallerIsNotPlatformAdmin(address caller); //        The caller of this function must be part of the platformAdmin group.
1819 
1820   error CallerIsNotSuperAdmin(address caller); //           The caller of this function must match the superAdmin address in storage.
1821 
1822   error CannotSetNewOwnerToTheZeroAddress(); //             You can't set the owner of this contract to the zero address (address(0)).
1823 
1824   error CannotSetToZeroAddress(); //                        The corresponding address cannot be set to the zero address (address(0)).
1825 
1826   error CannotSetNewTaxAdminToTheZeroAddress(); //          Cannot transfer the tax admin to the zero address (address(0)).
1827 
1828   error CollectionAlreadyRevealed(); //                     The collection is already revealed; you cannot call reveal again.
1829 
1830   error ContractIsPaused(); //                              The call requires the contract to be unpaused, and it is paused.
1831 
1832   error ContractIsNotPaused(); //                           The call required the contract to be paused, and it is NOT paused.
1833 
1834   error DecreasedAllowanceBelowZero(); //                   The request would decrease the allowance below zero, and that is not allowed.
1835 
1836   error DestinationIsNotTrustedSource(); //                 The destination that is being called through LZ has not been set as trusted.
1837 
1838   error GasLimitIsTooLow(); //                              The gas limit for the LayerZero call is too low.
1839 
1840   error IncorrectConfirmationValue(); //                    You need to enter the right confirmation value to call this funtion (usually 69420).
1841 
1842   error IncorrectPayment(); //                              The function call did not include passing the correct payment.
1843 
1844   error InitialLiquidityAlreadyAdded(); //                  Initial liquidity has already been added. You can't do it again.
1845 
1846   error InsufficientAllowance(); //                         There is not a high enough allowance for this operation.
1847 
1848   error InvalidAdapterParams(); //                          The current adapter params for LayerZero on this contract won't work :(.
1849 
1850   error InvalidAddress(); //                                An address being processed in the function is not valid.
1851 
1852   error InvalidEndpointCaller(); //                         The calling address is not a valid LZ endpoint. The LZ endpoint was set at contract creation
1853   //                                                        and cannot be altered after. Check the address LZ endpoint address on the contract.
1854 
1855   error InvalidMinGas(); //                                 The minimum gas setting for LZ in invalid.
1856 
1857   error InvalidOracleSignature(); //                        The signature provided with the contract call is not valid, either in format or signer.
1858 
1859   error InvalidPayload(); //                                The LZ payload is invalid
1860 
1861   error InvalidReceiver(); //                               The address used as a target for funds is not valid.
1862 
1863   error InvalidSourceSendingContract(); //                  The LZ message is being related from a source contract on another chain that is NOT trusted.
1864 
1865   error InvalidTotalShares(); //                            Total shares must equal 100 percent in basis points.
1866 
1867   error ListLengthMismatch(); //                            Two or more lists were compared and they did not match length.
1868 
1869   error LiquidityPoolMustBeAContractAddress(); //           Cannot add a non-contract as a liquidity pool.
1870 
1871   error LiquidityPoolCannotBeAddressZero(); //              Cannot add a liquidity pool from the zero address.
1872 
1873   error LPLockUpMustFitUint96(); //                         LP lockup is held in a uint96, so must fit.
1874 
1875   error NoTrustedPathRecord(); //                           LZ needs a trusted path record for this to work. What's that, you ask?
1876 
1877   error MaxBidQuantityIs255(); //                           Validation: as we use a uint8 array to track bid positions the max bid quantity is 255.
1878 
1879   error MaxPublicMintAllowanceExceeded(
1880     uint256 requested,
1881     uint256 alreadyMinted,
1882     uint256 maxAllowance
1883   ); //                                                     The calling address has requested a quantity that would exceed the max allowance.
1884 
1885   error MaxSupplyTooHigh(); //                              Max supply must fit in a uint128.
1886 
1887   error MaxTokensPerWalletExceeded(); //                    The transfer would exceed the max tokens per wallet limit.
1888 
1889   error MaxTokensPerTxnExceeded(); //                       The transfer would exceed the max tokens per transaction limit.
1890 
1891   error MetadataIsLocked(); //                              The metadata on this contract is locked; it cannot be altered!
1892 
1893   error MetadropFactoryOnlyOncePerReveal(); //              This function can only be called (a) by the factory and, (b) just one time!
1894 
1895   error MetadropModulesOnly(); //                           Can only be called from a metadrop contract.
1896 
1897   error MetadropOracleCannotBeAddressZero(); //             The metadrop Oracle cannot be the zero address (address(0)).
1898 
1899   error MinGasLimitNotSet(); //                             The minimum gas limit for LayerZero has not been set.
1900 
1901   error MintERC2309QuantityExceedsLimit(); //               The `quantity` minted with ERC2309 exceeds the safety limit.
1902 
1903   error MintingIsClosedForever(); //                        Minting is, as the error suggests, so over (and locked forever).
1904 
1905   error MintToZeroAddress(); //                             Cannot mint to the zero address.
1906 
1907   error MintZeroQuantity(); //                              The quantity of tokens minted must be more than zero.
1908 
1909   error NewBuyTaxBasisPointsExceedsMaximum(); //            Project owner trying to set the tax rate too high.
1910 
1911   error NewSellTaxBasisPointsExceedsMaximum(); //           Project owner trying to set the tax rate too high.
1912 
1913   error NoETHForLiquidityPair(); //                         No ETH has been provided for the liquidity pair.
1914 
1915   error TaxPeriodStillInForce(); //                         The minimum tax period has not yet expired.
1916 
1917   error NoPaymentDue(); //                                  No payment is due for this address.
1918 
1919   error NoRefundForCaller(); //                             Error thrown when the calling address has no refund owed.
1920 
1921   error NoStoredMessage(); //                               There is no stored message matching the passed parameters.
1922 
1923   error NoTokenForLiquidityPair(); //                       There is no token to add to the LP.
1924 
1925   error OperationDidNotSucceed(); //                        The operation failed (vague much?).
1926 
1927   error OracleSignatureHasExpired(); //                     A signature has been provided but it is too old.
1928 
1929   error OwnershipNotInitializedForExtraData(); //           The `extraData` cannot be set on an uninitialized ownership slot.
1930 
1931   error OwnerQueryForNonexistentToken(); //                 The token does not exist.
1932 
1933   error ParametersDoNotMatchSignedMessage(); //             The parameters passed with the signed message do not match the message itself.
1934 
1935   error PassedConfigDoesNotMatchApproved(); //              The config provided on the call does not match the approved config.
1936 
1937   error PauseCutOffHasPassed(); //                          The time period in which we can pause has passed; this contract can no longer be paused.
1938 
1939   error PaymentMustCoverPerMintFee(); //                    The payment passed must at least cover the per mint fee for the quantity requested.
1940 
1941   error PermitDidNotSucceed(); //                           The safeERC20 permit failed.
1942 
1943   error PlatformAdminCannotBeAddressZero(); //              We cannot use the zero address (address(0)) as a platformAdmin.
1944 
1945   error PlatformTreasuryCannotBeAddressZero(); //           The treasury address cannot be set to the zero address.
1946 
1947   error ProjectOwnerCannotBeAddressZero(); //               The project owner has to be a non zero address.
1948 
1949   error ProofInvalid(); //                                  The provided proof is not valid with the provided arguments.
1950 
1951   error QuantityExceedsRemainingCollectionSupply(); //      The requested quantity would breach the collection supply.
1952 
1953   error QuantityExceedsRemainingPhaseSupply(); //           The requested quantity would breach the phase supply.
1954 
1955   error QuantityExceedsMaxPossibleCollectionSupply(); //    The requested quantity would breach the maximum trackable supply
1956 
1957   error ReferralIdAlreadyUsed(); //                         This referral ID has already been used; they are one use only.
1958 
1959   error RequestingMoreThanRemainingAllocation(
1960     uint256 previouslyMinted,
1961     uint256 requested,
1962     uint256 remainingAllocation
1963   ); //                                                     Number of tokens requested for this mint exceeds the remaining allocation (taking the
1964   //                                                        original allocation from the list and deducting minted tokens).
1965 
1966   error RoyaltyFeeWillExceedSalePrice(); //                 The ERC2981 royalty specified will exceed the sale price.
1967 
1968   error ShareTotalCannotBeZero(); //                        The total of all the shares cannot be nothing.
1969 
1970   error SliceOutOfBounds(); //                              The bytes slice operation was out of bounds.
1971 
1972   error SliceOverflow(); //                                 The bytes slice operation overlowed.
1973 
1974   error SuperAdminCannotBeAddressZero(); //                 The superAdmin cannot be the sero address (address(0)).
1975 
1976   error SupplyTotalMismatch(); //                           The sum of the team supply and lp supply does not match.
1977 
1978   error SupportWindowIsNotOpen(); //                        The project owner has not requested support within the support request expiry window.
1979 
1980   error TaxFreeAddressCannotBeAddressZero(); //             A tax free address cannot be address(0)
1981 
1982   error TemplateCannotBeAddressZero(); //                   The address for a template cannot be address zero (address(0)).
1983 
1984   error TemplateNotFound(); //                              There is no template that matches the passed template Id.
1985 
1986   error ThisMintIsClosed(); //                              It's over (well, this mint is, anyway).
1987 
1988   error TotalSharesMustMatchDenominator(); //               The total of all shares must equal the denominator value.
1989 
1990   error TransferAmountExceedsBalance(); //                  The transfer amount exceeds the accounts available balance.
1991 
1992   error TransferCallerNotOwnerNorApproved(); //             The caller must own the token or be an approved operator.
1993 
1994   error TransferFailed(); //                                The transfer has failed.
1995 
1996   error TransferFromIncorrectOwner(); //                    The token must be owned by `from`.
1997 
1998   error TransferToNonERC721ReceiverImplementer(); //        Cannot safely transfer to a contract that does not implement the ERC721Receiver interface.
1999 
2000   error TransferFromZeroAddress(); //                       Cannot transfer from the zero address. Indeed, this surely is impossible, and likely a waste to check??
2001 
2002   error TransferToZeroAddress(); //                         Cannot transfer to the zero address.
2003 
2004   error UnrecognisedVRFMode(); //                           Currently supported VRF modes are 0: chainlink and 1: arrng
2005 
2006   error URIQueryForNonexistentToken(); //                   The token does not exist.
2007 
2008   error ValueExceedsMaximum(); //                           The value sent exceeds the maximum allowed (super useful explanation huh?).
2009 
2010   error VRFCoordinatorCannotBeAddressZero(); //             The VRF coordinator cannot be the zero address (address(0)).
2011 }
2012 
2013 
2014 // File contracts/ERC20FactoryV1/ERC20Factory/IERC20FactoryByMetadropV1.sol
2015 
2016 // 
2017 // Metadrop Contracts (v2.1.0)
2018 
2019 pragma solidity 0.8.19;
2020 
2021 
2022 
2023 
2024 /**
2025  * @dev Metadrop ERC-20 factory, interface
2026  */
2027 interface IERC20FactoryByMetadropV1 is
2028   IConfigStructures,
2029   IErrors,
2030   IERC20ConfigByMetadropV1
2031 {
2032   event ERC20Created(
2033     string metaId,
2034     address indexed deployer,
2035     address contractInstance,
2036     string symbol,
2037     string name
2038   );
2039 
2040   /**
2041    * @dev function {setMetadropOracleAddress} onlyPlatformAdmin
2042    *
2043    * Set the metadrop trusted oracle address
2044    *
2045    * @param metadropOracleAddress_ Trusted metadrop oracle address
2046    */
2047   function setMetadropOracleAddress(address metadropOracleAddress_) external;
2048 
2049   /**
2050    * @dev function {setMessageValidityInSeconds} onlyPlatformAdmin
2051    *
2052    * Set the validity period of signed messages
2053    *
2054    * @param messageValidityInSeconds_ Validity period in seconds for messages signed by the trusted oracle
2055    */
2056   function setMessageValidityInSeconds(
2057     uint256 messageValidityInSeconds_
2058   ) external;
2059 
2060   /**
2061    * @dev function {setPlatformTreasury} onlySuperAdmin
2062    *
2063    * Set the address that platform fees will be paid to / can be withdrawn to.
2064    * Note that this is restricted to the highest authority level, the super
2065    * admin. Platform admins can trigger a withdrawal to the treasury, but only
2066    * the default admin can set or alter the treasury address. It is recommended
2067    * that the default admin is highly secured and restrited e.g. a multi-sig.
2068    *
2069    * @param platformTreasury_ New treasury address
2070    */
2071   function setPlatformTreasury(address platformTreasury_) external;
2072 
2073   /**
2074    * @dev function {withdrawETH} onlyPlatformAdmin
2075    *
2076    * A withdraw function to allow ETH to be withdrawn to the treasury
2077    *
2078    * @param amount_ The amount to withdraw
2079    */
2080   function withdrawETH(uint256 amount_) external;
2081 
2082   /**
2083    * @dev function {withdrawERC20} onlyPlatformAdmin
2084    *
2085    * A withdraw function to allow ERC20s to be withdrawn to the treasury
2086    *
2087    * @param token_ The contract address of the token being withdrawn
2088    * @param amount_ The amount to withdraw
2089    */
2090   function withdrawERC20(IERC20 token_, uint256 amount_) external;
2091 
2092   /**
2093    * @dev function {createERC20}
2094    *
2095    * Create an ERC-20
2096    *
2097    * @param metaId_ The drop Id being approved
2098    * @param salt_ Salt for create2
2099    * @param erc20Config_ ERC20 configuration
2100    * @param signedMessage_ The signed message object
2101    * @param lockerFee_ The fee for the unicrypt locker
2102    * @param deploymentFee_ The fee for deployment, if any
2103    * @return deployedAddress_ The deployed ERC20 contract address
2104    */
2105   function createERC20(
2106     string calldata metaId_,
2107     bytes32 salt_,
2108     ERC20Config calldata erc20Config_,
2109     SignedDropMessageDetails calldata signedMessage_,
2110     uint256 lockerFee_,
2111     uint256 deploymentFee_
2112   ) external payable returns (address deployedAddress_);
2113 
2114   /**
2115    * @dev function {createConfigHash}
2116    *
2117    * Create the config hash
2118    *
2119    * @param metaId_ The drop Id being approved
2120    * @param salt_ Salt for create2
2121    * @param erc20Config_ ERC20 configuration
2122    * @param messageTimeStamp_ When the message for this config hash was signed
2123    * @param lockerFee_ The fee for the unicrypt locker
2124    * @param deploymentFee_ The fee for deployment, if any
2125    * @param deployer_ Address performing the deployment
2126    * @return configHash_ The bytes32 config hash
2127    */
2128   function createConfigHash(
2129     string calldata metaId_,
2130     bytes32 salt_,
2131     ERC20Config calldata erc20Config_,
2132     uint256 messageTimeStamp_,
2133     uint256 lockerFee_,
2134     uint256 deploymentFee_,
2135     address deployer_
2136   ) external pure returns (bytes32 configHash_);
2137 }
2138 
2139 
2140 // File contracts/Global/Revert.sol
2141 
2142 // 
2143 // Metadrop Contracts (v2.1.0)
2144 
2145 /**
2146  *
2147  * @title Revert.sol. For efficient reverts
2148  *
2149  * @author metadrop https://metadrop.com/
2150  *
2151  */
2152 
2153 pragma solidity 0.8.19;
2154 
2155 abstract contract Revert {
2156   /**
2157    * @dev For more efficient reverts.
2158    */
2159   function _revert(bytes4 errorSelector) internal pure {
2160     assembly {
2161       mstore(0x00, errorSelector)
2162       revert(0x00, 0x04)
2163     }
2164   }
2165 }
2166 
2167 
2168 // File contracts/Global/OZ/Ownable.sol
2169 
2170 // 
2171 // Metadrop Contracts (v2.1.0)
2172 // Metadrop based on OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable.sol)
2173 
2174 pragma solidity 0.8.19;
2175 
2176 
2177 
2178 /**
2179  * @dev Contract module which provides a basic access control mechanism, where
2180  * there is an account (an owner) that can be granted exclusive access to
2181  * specific functions.
2182  *
2183  * By default, the owner account will be the one that deploys the contract. This
2184  * can later be changed with {transferOwnership}.
2185  *
2186  * This module is used through inheritance. It will make available the modifier
2187  * `onlyOwner`, which can be applied to your functions to restrict their use to
2188  * the owner.
2189  */
2190 abstract contract Ownable is IErrors, Revert, Context {
2191   address private _owner;
2192 
2193   event OwnershipTransferred(
2194     address indexed previousOwner,
2195     address indexed newOwner
2196   );
2197 
2198   /**
2199    * @dev Initializes the contract setting the deployer as the initial owner.
2200    */
2201   constructor() {
2202     _transferOwnership(_msgSender());
2203   }
2204 
2205   /**
2206    * @dev Throws if called by any account other than the owner.
2207    */
2208   modifier onlyOwner() {
2209     _checkOwner();
2210     _;
2211   }
2212 
2213   /**
2214    * @dev Returns the address of the current owner.
2215    */
2216   function owner() public view virtual returns (address) {
2217     return _owner;
2218   }
2219 
2220   /**
2221    * @dev Throws if the sender is not the owner.
2222    */
2223   function _checkOwner() internal view virtual {
2224     if (owner() != _msgSender()) {
2225       _revert(CallerIsNotTheOwner.selector);
2226     }
2227   }
2228 
2229   /**
2230    * @dev Leaves the contract without owner. It will not be possible to call
2231    * `onlyOwner` functions. Can only be called by the current owner.
2232    *
2233    * NOTE: Renouncing ownership will leave the contract without an owner,
2234    * thereby disabling any functionality that is only available to the owner.
2235    */
2236   function renounceOwnership() public virtual onlyOwner {
2237     _transferOwnership(address(0));
2238   }
2239 
2240   /**
2241    * @dev Transfers ownership of the contract to a new account (`newOwner`).
2242    * Can only be called by the current owner.
2243    */
2244   function transferOwnership(address newOwner) public virtual onlyOwner {
2245     if (newOwner == address(0)) {
2246       _revert(CannotSetNewOwnerToTheZeroAddress.selector);
2247     }
2248     _transferOwnership(newOwner);
2249   }
2250 
2251   /**
2252    * @dev Transfers ownership of the contract to a new account (`newOwner`).
2253    * Internal function without access restriction.
2254    */
2255   function _transferOwnership(address newOwner) internal virtual {
2256     address oldOwner = _owner;
2257     _owner = newOwner;
2258     emit OwnershipTransferred(oldOwner, newOwner);
2259   }
2260 }
2261 
2262 
2263 // File @openzeppelin/contracts/token/ERC20/extensions/IERC20Permit.sol@v4.9.1
2264 
2265 // 
2266 // OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/IERC20Permit.sol)
2267 
2268 pragma solidity ^0.8.0;
2269 
2270 /**
2271  * @dev Interface of the ERC20 Permit extension allowing approvals to be made via signatures, as defined in
2272  * https://eips.ethereum.org/EIPS/eip-2612[EIP-2612].
2273  *
2274  * Adds the {permit} method, which can be used to change an account's ERC20 allowance (see {IERC20-allowance}) by
2275  * presenting a message signed by the account. By not relying on {IERC20-approve}, the token holder account doesn't
2276  * need to send a transaction, and thus is not required to hold Ether at all.
2277  */
2278 interface IERC20Permit {
2279     /**
2280      * @dev Sets `value` as the allowance of `spender` over ``owner``'s tokens,
2281      * given ``owner``'s signed approval.
2282      *
2283      * IMPORTANT: The same issues {IERC20-approve} has related to transaction
2284      * ordering also apply here.
2285      *
2286      * Emits an {Approval} event.
2287      *
2288      * Requirements:
2289      *
2290      * - `spender` cannot be the zero address.
2291      * - `deadline` must be a timestamp in the future.
2292      * - `v`, `r` and `s` must be a valid `secp256k1` signature from `owner`
2293      * over the EIP712-formatted function arguments.
2294      * - the signature must use ``owner``'s current nonce (see {nonces}).
2295      *
2296      * For more information on the signature format, see the
2297      * https://eips.ethereum.org/EIPS/eip-2612#specification[relevant EIP
2298      * section].
2299      */
2300     function permit(
2301         address owner,
2302         address spender,
2303         uint256 value,
2304         uint256 deadline,
2305         uint8 v,
2306         bytes32 r,
2307         bytes32 s
2308     ) external;
2309 
2310     /**
2311      * @dev Returns the current nonce for `owner`. This value must be
2312      * included whenever a signature is generated for {permit}.
2313      *
2314      * Every successful call to {permit} increases ``owner``'s nonce by one. This
2315      * prevents a signature from being used multiple times.
2316      */
2317     function nonces(address owner) external view returns (uint256);
2318 
2319     /**
2320      * @dev Returns the domain separator used in the encoding of the signature for {permit}, as defined by {EIP712}.
2321      */
2322     // solhint-disable-next-line func-name-mixedcase
2323     function DOMAIN_SEPARATOR() external view returns (bytes32);
2324 }
2325 
2326 
2327 // File @openzeppelin/contracts/utils/Address.sol@v4.9.1
2328 
2329 // 
2330 // OpenZeppelin Contracts (last updated v4.9.0) (utils/Address.sol)
2331 
2332 pragma solidity ^0.8.1;
2333 
2334 /**
2335  * @dev Collection of functions related to the address type
2336  */
2337 library Address {
2338     /**
2339      * @dev Returns true if `account` is a contract.
2340      *
2341      * [IMPORTANT]
2342      * ====
2343      * It is unsafe to assume that an address for which this function returns
2344      * false is an externally-owned account (EOA) and not a contract.
2345      *
2346      * Among others, `isContract` will return false for the following
2347      * types of addresses:
2348      *
2349      *  - an externally-owned account
2350      *  - a contract in construction
2351      *  - an address where a contract will be created
2352      *  - an address where a contract lived, but was destroyed
2353      *
2354      * Furthermore, `isContract` will also return true if the target contract within
2355      * the same transaction is already scheduled for destruction by `SELFDESTRUCT`,
2356      * which only has an effect at the end of a transaction.
2357      * ====
2358      *
2359      * [IMPORTANT]
2360      * ====
2361      * You shouldn't rely on `isContract` to protect against flash loan attacks!
2362      *
2363      * Preventing calls from contracts is highly discouraged. It breaks composability, breaks support for smart wallets
2364      * like Gnosis Safe, and does not provide security since it can be circumvented by calling from a contract
2365      * constructor.
2366      * ====
2367      */
2368     function isContract(address account) internal view returns (bool) {
2369         // This method relies on extcodesize/address.code.length, which returns 0
2370         // for contracts in construction, since the code is only stored at the end
2371         // of the constructor execution.
2372 
2373         return account.code.length > 0;
2374     }
2375 
2376     /**
2377      * @dev Replacement for Solidity's `transfer`: sends `amount` wei to
2378      * `recipient`, forwarding all available gas and reverting on errors.
2379      *
2380      * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost
2381      * of certain opcodes, possibly making contracts go over the 2300 gas limit
2382      * imposed by `transfer`, making them unable to receive funds via
2383      * `transfer`. {sendValue} removes this limitation.
2384      *
2385      * https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/[Learn more].
2386      *
2387      * IMPORTANT: because control is transferred to `recipient`, care must be
2388      * taken to not create reentrancy vulnerabilities. Consider using
2389      * {ReentrancyGuard} or the
2390      * https://solidity.readthedocs.io/en/v0.8.0/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].
2391      */
2392     function sendValue(address payable recipient, uint256 amount) internal {
2393         require(address(this).balance >= amount, "Address: insufficient balance");
2394 
2395         (bool success, ) = recipient.call{value: amount}("");
2396         require(success, "Address: unable to send value, recipient may have reverted");
2397     }
2398 
2399     /**
2400      * @dev Performs a Solidity function call using a low level `call`. A
2401      * plain `call` is an unsafe replacement for a function call: use this
2402      * function instead.
2403      *
2404      * If `target` reverts with a revert reason, it is bubbled up by this
2405      * function (like regular Solidity function calls).
2406      *
2407      * Returns the raw returned data. To convert to the expected return value,
2408      * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].
2409      *
2410      * Requirements:
2411      *
2412      * - `target` must be a contract.
2413      * - calling `target` with `data` must not revert.
2414      *
2415      * _Available since v3.1._
2416      */
2417     function functionCall(address target, bytes memory data) internal returns (bytes memory) {
2418         return functionCallWithValue(target, data, 0, "Address: low-level call failed");
2419     }
2420 
2421     /**
2422      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with
2423      * `errorMessage` as a fallback revert reason when `target` reverts.
2424      *
2425      * _Available since v3.1._
2426      */
2427     function functionCall(
2428         address target,
2429         bytes memory data,
2430         string memory errorMessage
2431     ) internal returns (bytes memory) {
2432         return functionCallWithValue(target, data, 0, errorMessage);
2433     }
2434 
2435     /**
2436      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
2437      * but also transferring `value` wei to `target`.
2438      *
2439      * Requirements:
2440      *
2441      * - the calling contract must have an ETH balance of at least `value`.
2442      * - the called Solidity function must be `payable`.
2443      *
2444      * _Available since v3.1._
2445      */
2446     function functionCallWithValue(address target, bytes memory data, uint256 value) internal returns (bytes memory) {
2447         return functionCallWithValue(target, data, value, "Address: low-level call with value failed");
2448     }
2449 
2450     /**
2451      * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but
2452      * with `errorMessage` as a fallback revert reason when `target` reverts.
2453      *
2454      * _Available since v3.1._
2455      */
2456     function functionCallWithValue(
2457         address target,
2458         bytes memory data,
2459         uint256 value,
2460         string memory errorMessage
2461     ) internal returns (bytes memory) {
2462         require(address(this).balance >= value, "Address: insufficient balance for call");
2463         (bool success, bytes memory returndata) = target.call{value: value}(data);
2464         return verifyCallResultFromTarget(target, success, returndata, errorMessage);
2465     }
2466 
2467     /**
2468      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
2469      * but performing a static call.
2470      *
2471      * _Available since v3.3._
2472      */
2473     function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {
2474         return functionStaticCall(target, data, "Address: low-level static call failed");
2475     }
2476 
2477     /**
2478      * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
2479      * but performing a static call.
2480      *
2481      * _Available since v3.3._
2482      */
2483     function functionStaticCall(
2484         address target,
2485         bytes memory data,
2486         string memory errorMessage
2487     ) internal view returns (bytes memory) {
2488         (bool success, bytes memory returndata) = target.staticcall(data);
2489         return verifyCallResultFromTarget(target, success, returndata, errorMessage);
2490     }
2491 
2492     /**
2493      * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
2494      * but performing a delegate call.
2495      *
2496      * _Available since v3.4._
2497      */
2498     function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {
2499         return functionDelegateCall(target, data, "Address: low-level delegate call failed");
2500     }
2501 
2502     /**
2503      * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],
2504      * but performing a delegate call.
2505      *
2506      * _Available since v3.4._
2507      */
2508     function functionDelegateCall(
2509         address target,
2510         bytes memory data,
2511         string memory errorMessage
2512     ) internal returns (bytes memory) {
2513         (bool success, bytes memory returndata) = target.delegatecall(data);
2514         return verifyCallResultFromTarget(target, success, returndata, errorMessage);
2515     }
2516 
2517     /**
2518      * @dev Tool to verify that a low level call to smart-contract was successful, and revert (either by bubbling
2519      * the revert reason or using the provided one) in case of unsuccessful call or if target was not a contract.
2520      *
2521      * _Available since v4.8._
2522      */
2523     function verifyCallResultFromTarget(
2524         address target,
2525         bool success,
2526         bytes memory returndata,
2527         string memory errorMessage
2528     ) internal view returns (bytes memory) {
2529         if (success) {
2530             if (returndata.length == 0) {
2531                 // only check isContract if the call was successful and the return data is empty
2532                 // otherwise we already know that it was a contract
2533                 require(isContract(target), "Address: call to non-contract");
2534             }
2535             return returndata;
2536         } else {
2537             _revert(returndata, errorMessage);
2538         }
2539     }
2540 
2541     /**
2542      * @dev Tool to verify that a low level call was successful, and revert if it wasn't, either by bubbling the
2543      * revert reason or using the provided one.
2544      *
2545      * _Available since v4.3._
2546      */
2547     function verifyCallResult(
2548         bool success,
2549         bytes memory returndata,
2550         string memory errorMessage
2551     ) internal pure returns (bytes memory) {
2552         if (success) {
2553             return returndata;
2554         } else {
2555             _revert(returndata, errorMessage);
2556         }
2557     }
2558 
2559     function _revert(bytes memory returndata, string memory errorMessage) private pure {
2560         // Look for revert reason and bubble it up if present
2561         if (returndata.length > 0) {
2562             // The easiest way to bubble the revert reason is using memory via assembly
2563             /// @solidity memory-safe-assembly
2564             assembly {
2565                 let returndata_size := mload(returndata)
2566                 revert(add(32, returndata), returndata_size)
2567             }
2568         } else {
2569             revert(errorMessage);
2570         }
2571     }
2572 }
2573 
2574 
2575 // File contracts/Global/OZ/SafeERC20.sol
2576 
2577 // 
2578 // Metadrop Contracts (v2.1.0)
2579 // Metadrop based on OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/utils/SafeERC20.sol)
2580 
2581 pragma solidity 0.8.19;
2582 
2583 
2584 
2585 
2586 /**
2587  * @title SafeERC20
2588  * @dev Wrappers around ERC20 operations that throw on failure (when the token
2589  * contract returns false). Tokens that return no value (and instead revert or
2590  * throw on failure) are also supported, non-reverting calls are assumed to be
2591  * successful.
2592  * To use this library you can add a `using SafeERC20 for IERC20;` statement to your contract,
2593  * which allows you to call the safe operations as `token.safeTransfer(...)`, etc.
2594  */
2595 library SafeERC20 {
2596   using Address for address;
2597 
2598   /**
2599    * @dev Transfer `value` amount of `token` from the calling contract to `to`. If `token` returns no value,
2600    * non-reverting calls are assumed to be successful.
2601    */
2602   function safeTransfer(IERC20 token, address to, uint256 value) internal {
2603     _callOptionalReturn(token, abi.encodeCall(token.transfer, (to, value)));
2604   }
2605 
2606   /**
2607    * @dev Transfer `value` amount of `token` from `from` to `to`, spending the approval given by `from` to the
2608    * calling contract. If `token` returns no value, non-reverting calls are assumed to be successful.
2609    */
2610   function safeTransferFrom(
2611     IERC20 token,
2612     address from,
2613     address to,
2614     uint256 value
2615   ) internal {
2616     _callOptionalReturn(
2617       token,
2618       abi.encodeCall(token.transferFrom, (from, to, value))
2619     );
2620   }
2621 
2622   /**
2623    * @dev Increase the calling contract's allowance toward `spender` by `value`. If `token` returns no value,
2624    * non-reverting calls are assumed to be successful.
2625    */
2626   function safeIncreaseAllowance(
2627     IERC20 token,
2628     address spender,
2629     uint256 value
2630   ) internal {
2631     uint256 oldAllowance = token.allowance(address(this), spender);
2632     forceApprove(token, spender, oldAllowance + value);
2633   }
2634 
2635   /**
2636    * @dev Decrease the calling contract's allowance toward `spender` by `value`. If `token` returns no value,
2637    * non-reverting calls are assumed to be successful.
2638    */
2639   function safeDecreaseAllowance(
2640     IERC20 token,
2641     address spender,
2642     uint256 value
2643   ) internal {
2644     unchecked {
2645       uint256 oldAllowance = token.allowance(address(this), spender);
2646       if (oldAllowance < value) {
2647         revert IErrors.DecreasedAllowanceBelowZero();
2648       }
2649       forceApprove(token, spender, oldAllowance - value);
2650     }
2651   }
2652 
2653   /**
2654    * @dev Set the calling contract's allowance toward `spender` to `value`. If `token` returns no value,
2655    * non-reverting calls are assumed to be successful. Compatible with tokens that require the approval to be set to
2656    * 0 before setting it to a non-zero value.
2657    */
2658   function forceApprove(IERC20 token, address spender, uint256 value) internal {
2659     bytes memory approvalCall = abi.encodeCall(token.approve, (spender, value));
2660 
2661     if (!_callOptionalReturnBool(token, approvalCall)) {
2662       _callOptionalReturn(token, abi.encodeCall(token.approve, (spender, 0)));
2663       _callOptionalReturn(token, approvalCall);
2664     }
2665   }
2666 
2667   /**
2668    * @dev Use a ERC-2612 signature to set the `owner` approval toward `spender` on `token`.
2669    * Revert on invalid signature.
2670    */
2671   function safePermit(
2672     IERC20Permit token,
2673     address owner,
2674     address spender,
2675     uint256 value,
2676     uint256 deadline,
2677     uint8 v,
2678     bytes32 r,
2679     bytes32 s
2680   ) internal {
2681     uint256 nonceBefore = token.nonces(owner);
2682     token.permit(owner, spender, value, deadline, v, r, s);
2683     uint256 nonceAfter = token.nonces(owner);
2684     if (nonceAfter != (nonceBefore + 1)) {
2685       revert IErrors.PermitDidNotSucceed();
2686     }
2687   }
2688 
2689   /**
2690    * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement
2691    * on the return value: the return value is optional (but if data is returned, it must not be false).
2692    * @param token The token targeted by the call.
2693    * @param data The call data (encoded using abi.encode or one of its variants).
2694    */
2695   function _callOptionalReturn(IERC20 token, bytes memory data) private {
2696     // We need to perform a low level call here, to bypass Solidity's return data size checking mechanism, since
2697     // we're implementing it ourselves. We use {Address-functionCall} to perform this call, which verifies that
2698     // the target address contains contract code and also asserts for success in the low-level call.
2699 
2700     bytes memory returndata = address(token).functionCall(data, "call fail");
2701     if ((returndata.length != 0) && !abi.decode(returndata, (bool))) {
2702       revert IErrors.OperationDidNotSucceed();
2703     }
2704   }
2705 
2706   /**
2707    * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement
2708    * on the return value: the return value is optional (but if data is returned, it must not be false).
2709    * @param token The token targeted by the call.
2710    * @param data The call data (encoded using abi.encode or one of its variants).
2711    *
2712    * This is a variant of {_callOptionalReturn} that silents catches all reverts and returns a bool instead.
2713    */
2714   function _callOptionalReturnBool(
2715     IERC20 token,
2716     bytes memory data
2717   ) private returns (bool) {
2718     // We need to perform a low level call here, to bypass Solidity's return data size checking mechanism, since
2719     // we're implementing it ourselves. We cannot use {Address-functionCall} here since this should return false
2720     // and not revert is the subcall reverts.
2721 
2722     (bool success, bytes memory returndata) = address(token).call(data);
2723     return
2724       success &&
2725       (returndata.length == 0 || abi.decode(returndata, (bool))) &&
2726       address(token).code.length > 0;
2727   }
2728 }
2729 
2730 
2731 // File contracts/Global/TaxAdmin.sol
2732 
2733 // 
2734 // Metadrop Contracts (v2.1.0)
2735 // Metadrop based on OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable.sol)
2736 
2737 pragma solidity 0.8.19;
2738 
2739 
2740 
2741 /**
2742  * @dev Contract module which provides a basic access control mechanism, where
2743  * there is an account (an owner) that can be granted exclusive access to
2744  * specific functions.
2745  *
2746  * By default, the owner account will be the one that deploys the contract. This
2747  * can later be changed with {transferOwnership}.
2748  *
2749  * This module is used through inheritance. It will make available the modifier
2750  * `onlyOwner`, which can be applied to your functions to restrict their use to
2751  * the owner.
2752  */
2753 abstract contract TaxAdmin is IErrors, Revert, Context {
2754   address private _taxAdmin;
2755 
2756   event TaxAdminTransferred(
2757     address indexed previousTaxAdmin,
2758     address indexed newTaxAdmin
2759   );
2760 
2761   constructor() {}
2762 
2763   /**
2764    * @dev Throws if called by any account other than the tax admin.
2765    */
2766   modifier onlyTaxAdmin() {
2767     _checkTaxAdmin();
2768     _;
2769   }
2770 
2771   /**
2772    * @dev Returns the address of the current tax admin.
2773    */
2774   function taxAdmin() public view virtual returns (address) {
2775     return _taxAdmin;
2776   }
2777 
2778   /**
2779    * @dev Throws if the sender is not the tax admin.
2780    */
2781   function _checkTaxAdmin() internal view virtual {
2782     if (taxAdmin() != _msgSender()) {
2783       _revert(CallerIsNotTheTaxAdmin.selector);
2784     }
2785   }
2786 
2787   /**
2788    * @dev Leaves the contract without a tax admin. It will not be possible to call
2789    * `onlyTaxAdmin` functions. Can only be called by the current tax admin.
2790    *
2791    * NOTE: Renouncing taxAdmin will leave the contract without an tax admim,
2792    * thereby disabling any functionality that is only available to the tax admin.
2793    */
2794   function renounceTaxAdmin() public virtual onlyTaxAdmin {
2795     _transferTaxAdmin(address(0));
2796   }
2797 
2798   /**
2799    * @dev Transfers the tax admin of the contract to a new account (`newTaxAdmin`).
2800    * Can only be called by the current tax admin.
2801    */
2802   function transferTaxAdmin(address newTaxAdmin) public virtual onlyTaxAdmin {
2803     if (newTaxAdmin == address(0)) {
2804       _revert(CannotSetNewTaxAdminToTheZeroAddress.selector);
2805     }
2806     _transferTaxAdmin(newTaxAdmin);
2807   }
2808 
2809   /**
2810    * @dev Transfers the tax admin of the contract to a new account (`newTaxAdmin`).
2811    * Internal function without access restriction.
2812    */
2813   function _transferTaxAdmin(address newTaxAdmin) internal virtual {
2814     address oldTaxAdmin = _taxAdmin;
2815     _taxAdmin = newTaxAdmin;
2816     emit TaxAdminTransferred(oldTaxAdmin, newTaxAdmin);
2817   }
2818 }
2819 
2820 
2821 // File contracts/ThirdParty/omnus/ERC20Spendable/IERC20Spendable.sol
2822 
2823 // 
2824 // Omnus Contracts v3
2825 // https://omn.us/spendable
2826 // https://github.com/omnus/ERC20Spendable
2827 // npm: @omnus/ERC20Spendable
2828 
2829 pragma solidity ^0.8.19;
2830 
2831 /**
2832  * @title ERC-7492 IERC20Spendable.sol
2833  *
2834  * @author omnus
2835  * https://omn.us
2836  *
2837  * @dev Implementation of {IERC20Spendable} interface.
2838  *
2839  * {ERC-7492 ERC20Spendable} allows ERC20s to operate as 'spendable' items, i.e. an ERC20 token that
2840  * can trigger an action on another contract at the same time as being transfered. Similar to ERC677
2841  * and the hooks in ERC777, but with more of an empasis on interoperability (returned values) than
2842  * ERC677 and specifically scoped interaction rather than the general hooks of ERC777.
2843  *
2844  * For more detailed notes please see our guide https://omn.us/how-to-implement-erc20-spendable
2845  */
2846 
2847 interface IERC20Spendable {
2848   /// @dev Error {ERC20SpendableInvalidReveiver} The called contract does not support ERC20Spendable.
2849   error ERC20SpendableInvalidReveiver(address receiver);
2850 
2851   /// @dev Event {SpendReceipt} issued on successful return from the {ERC20SpendableReceiver} call.
2852   event SpendReceipt(
2853     address spender,
2854     address receiver,
2855     uint256 amount,
2856     bytes sentArguments,
2857     bytes returnedArguments
2858   );
2859 
2860   /**
2861    * @dev {spend} Allows the transfer of the owners token to the receiver, a call on the receiver,
2862    * and then the return of information from the receiver back up the call stack.
2863    *
2864    * Overloaded method - call this if you are not specifying any arguments.
2865    *
2866    * @param receiver_ The receiving address for this token spend. Contracts must implement
2867    * ERCSpendableReceiver to receive spendadle tokens. For more detail see {ERC20SpendableReceiver}.
2868    * @param spent_ The amount of token being spent. This will be transfered as part of this call and
2869    * provided as an argument on the call to {onERC20SpendableReceived} on the {ERC20SpendableReceiver}.
2870    */
2871   function spend(address receiver_, uint256 spent_) external;
2872 
2873   /**
2874    * @dev {spend} Allows the transfer of the owners token to the receiver, a call on the receiver, and
2875    * the return of information from the receiver back up the call stack.
2876    *
2877    * Overloaded method - call this to specify a bytes argument.
2878    *
2879    * @param receiver_ The receiving address for this token spend. Contracts must implement
2880    * ERCSpendableReceiver to receive spendadle tokens. For more detail see {ERC20SpendableReceiver}.
2881    * @param spent_ The amount of token being spent. This will be transfered as part of this call and
2882    * provided as an argument on the call to {onERC20SpendableReceived} on the {ERC20SpendableReceiver}.
2883    * @param arguments_ Bytes argument to send with the call. See {mock} contracts for details on encoding
2884    * and decoding arguments from bytes.
2885    */
2886   function spend(
2887     address receiver_,
2888     uint256 spent_,
2889     bytes memory arguments_
2890   ) external;
2891 }
2892 
2893 
2894 // File contracts/ThirdParty/omnus/ERC20Spendable/IERC20SpendableReceiver.sol
2895 
2896 // 
2897 // Omnus Contracts v3
2898 // https://omn.us/spendable
2899 // https://github.com/omnus/ERC20Spendable
2900 // npm: @omnus/ERC20Spendable
2901 
2902 pragma solidity ^0.8.19;
2903 
2904 /**
2905  * @title ERC-7492 IERC20SpendableReceiver.sol
2906  *
2907  * @author omnus
2908  * https://omn.us
2909  *
2910  * @dev Implementation of {IERC20SpendableReceiver} interface.
2911  *
2912  * {ERC-7492 ERC20Spendable} allows ERC20s to operate as 'spendable' items, i.e. an ERC20 token that
2913  * can trigger an action on another contract at the same time as being transfered. Similar to ERC677
2914  * and the hooks in ERC777, but with more of an empasis on interoperability (returned values) than
2915  * ERC677 and specifically scoped interaction rather than the general hooks of ERC777.
2916  *
2917  * For more detailed notes please see our guide https://omn.us/how-to-implement-erc20-spendable
2918  */
2919 
2920 interface IERC20SpendableReceiver {
2921   ///@dev Error {CallMustBeFromSpendableToken}. The call to this method can only be from a designated spendable token.
2922   error CallMustBeFromSpendableToken();
2923 
2924   /**
2925    * @dev {onERC20SpendableReceived} External function called by ERC20SpendableTokens. This
2926    * validates that the token is valid and then calls the internal {_handleSpend} method.
2927    * You must overried {_handleSpend} in your contract to perform processing you wish to occur
2928    * on token spend.
2929    *
2930    * This method will pass back the valid bytes4 selector and any bytes argument passed from
2931    * {_handleSpend}.
2932    *
2933    * @param spender_ The address spending the ERC20Spendable
2934    * @param spent_ The amount of token spent
2935    * @param arguments_ Bytes sent with the call
2936    */
2937   function onERC20SpendableReceived(
2938     address spender_,
2939     uint256 spent_,
2940     bytes memory arguments_
2941   ) external returns (bytes4 retval_, bytes memory returnArguments_);
2942 }
2943 
2944 
2945 // File contracts/ThirdParty/omnus/ERC20Spendable/ERC20Spendable.sol
2946 
2947 // 
2948 // Omnus Contracts v3
2949 // https://omn.us/spendable
2950 // https://github.com/omnus/ERC20Spendable
2951 // npm: @omnus/ERC20Spendable
2952 
2953 pragma solidity 0.8.19;
2954 
2955 
2956 
2957 /**
2958  * @title ERC-7492 ERC20Spendable.sol
2959  *
2960  * @author omnus
2961  * https://omn.us
2962  *
2963  * @dev Implementation of {ERC20Spendable}.
2964  *
2965  * {ERC-7492 ERC20Spendable} allows ERC20s to operate as 'spendable' items, i.e. an ERC20 token that
2966  * can trigger an action on another contract at the same time as being transfered. Similar to ERC677
2967  * and the hooks in ERC777, but with more of an empasis on interoperability (returned values) than
2968  * ERC677 and specifically scoped interaction rather than the general hooks of ERC777.
2969  *
2970  * For more detailed notes please see our guide https://omn.us/how-to-implement-erc20-spendable
2971  */
2972 abstract contract ERC20Spendable is Context, IERC20Spendable {
2973   /**
2974    * @dev {spend} Allows the transfer of the owners token to the receiver, a call on the receiver,
2975    * and then the return of information from the receiver back up the call stack.
2976    *
2977    * Overloaded method - call this if you are not specifying any arguments.
2978    *
2979    * @param receiver_ The receiving address for this token spend. Contracts must implement
2980    * ERCSpendableReceiver to receive spendadle tokens. For more detail see {ERC20SpendableReceiver}.
2981    * @param spent_ The amount of token being spent. This will be transfered as part of this call and
2982    * provided as an argument on the call to {onERC20SpendableReceived} on the {ERC20SpendableReceiver}.
2983    */
2984   function spend(address receiver_, uint256 spent_) public virtual {
2985     spend(receiver_, spent_, "");
2986   }
2987 
2988   /**
2989    * @dev {spend} Allows the transfer of the owners token to the receiver, a call on the receiver, and
2990    * the return of information from the receiver back up the call stack.
2991    *
2992    * Overloaded method - call this to specify a bytes argument.
2993    *
2994    * @param receiver_ The receiving address for this token spend. Contracts must implement
2995    * ERCSpendableReceiver to receive spendadle tokens. For more detail see {ERC20SpendableReceiver}.
2996    * @param spent_ The amount of token being spent. This will be transfered as part of this call and
2997    * provided as an argument on the call to {onERC20SpendableReceived} on the {ERC20SpendableReceiver}.
2998    * @param arguments_ Bytes argument to send with the call. See {mock} contracts for details on encoding
2999    * and decoding arguments from bytes.
3000    */
3001   function spend(
3002     address receiver_,
3003     uint256 spent_,
3004     bytes memory arguments_
3005   ) public virtual {
3006     /**
3007      * @dev Transfer tokens to the receiver contract IF this is a non-0 amount. Don't try and transfer 0,
3008      * which leavesopen the possibility that the call is free. If not, the function call after will fail
3009      * and revert. Why would a {spend} method call ever be free? For example, a service provider may be
3010      * taking their ERC20 token as payment for a service. But they want to offer it for free, perhaps for a
3011      * limited time. Under this situation the spend callcan be used in all cases, but sending 0 token while
3012      * it is free, removing the need for different interfaces.
3013      *
3014      * We use the standard ERC20 public transfer method for the transfer, which means two things:
3015      * 1) This can only be called by the token owner (but that is the entire point!)
3016      * 2) We inherit all of the security checks in this method (e.g. owner has sufficient balance etc.)
3017      */
3018     if (spent_ != 0) {
3019       transfer(receiver_, spent_);
3020     }
3021 
3022     /**
3023      * @dev Perform actions on the receiver and return arguments back up the callstack. In addition to allowing
3024      * the execution of the hook within the receiver, this call provides the same feature as onERC721Received
3025      * in the ERC721 standard.
3026      */
3027     if (receiver_.code.length > 0) {
3028       try
3029         IERC20SpendableReceiver(receiver_).onERC20SpendableReceived(
3030           _msgSender(),
3031           spent_,
3032           arguments_
3033         )
3034       returns (bytes4 retval, bytes memory returnedArguments) {
3035         if (
3036           retval != IERC20SpendableReceiver.onERC20SpendableReceived.selector
3037         ) {
3038           revert ERC20SpendableInvalidReveiver(receiver_);
3039         }
3040         emit SpendReceipt(
3041           _msgSender(),
3042           receiver_,
3043           spent_,
3044           arguments_,
3045           returnedArguments
3046         );
3047         /// @dev Handle returned values. Specify an override {_handleReceipt} method in your ERC20 contract if
3048         /// you wish to handle returned arguments.
3049         _handleReceipt(returnedArguments);
3050       } catch (bytes memory reason) {
3051         if (reason.length == 0) {
3052           revert ERC20SpendableInvalidReveiver(receiver_);
3053         } else {
3054           /// @solidity memory-safe-assembly
3055           assembly {
3056             revert(add(32, reason), mload(reason))
3057           }
3058         }
3059       }
3060     }
3061   }
3062 
3063   /**
3064    * @dev {_handleReceipt} Internal function called on completion of a call to {onERC20SpendableReceived}
3065    * on the {ERC20SpendableReceiver}.
3066    *
3067    * When making a token {ERC20Spendable} if you wish to process receipts you need to override
3068    * {_handleReceipt} in your contract. For an example, see {mock} contract {MockSpendableERC20ReturnedArgs}.
3069    *
3070    * @param returnedArguments_ Bytes argument to returned from the call. See {mock} contracts for details on
3071    * encoding and decoding arguments from bytes.
3072    */
3073   function _handleReceipt(bytes memory returnedArguments_) internal virtual {}
3074 
3075   /**
3076    * @dev See {IERC165-supportsInterface}. This can be used to determine if an ERC20 is ERC20Spendable. For
3077    * example, a DEX may check this value, and make use of a single {spend} transaction (rather than the current
3078    * model of [approve -> pull]) if the ERC20Spendable interface is supported.
3079    *
3080    * @param interfaceId_ The bytes4 interface identifier being checked.
3081    */
3082   function supportsInterface(
3083     bytes4 interfaceId_
3084   ) public view virtual returns (bool) {
3085     // The interface IDs are constants representing the first 4 bytes
3086     // of the XOR of all function selectors in the interface.
3087     // See: [ERC165](https://eips.ethereum.org/EIPS/eip-165)
3088     // (e.g. `bytes4(i.functionA.selector ^ i.functionB.selector ^ ...)`)
3089     return interfaceId_ == type(IERC20Spendable).interfaceId;
3090   }
3091 
3092   /**
3093    * @dev override this in your implementation
3094    *
3095    * @dev See {IERC20-transfer}.
3096    *
3097    * Requirements:
3098    *
3099    * - `to` cannot be the zero address.
3100    * - the caller must have a balance of at least `amount`.
3101    */
3102   function transfer(address to, uint256 amount) public virtual returns (bool) {}
3103 }
3104 
3105 
3106 // File contracts/ThirdParty/Unicrypt/IUniswapV2Locker.sol
3107 
3108 // Interface definition for UniswapV2Locker.sol
3109 
3110 pragma solidity 0.8.19;
3111 
3112 interface IERCBurn {
3113   function burn(uint256 _amount) external;
3114 
3115   function approve(address spender, uint256 amount) external returns (bool);
3116 
3117   function allowance(address owner, address spender) external returns (uint256);
3118 
3119   function balanceOf(address account) external view returns (uint256);
3120 }
3121 
3122 interface IMigrator {
3123   function migrate(
3124     address lpToken,
3125     uint256 amount,
3126     uint256 unlockDate,
3127     address owner
3128   ) external returns (bool);
3129 }
3130 
3131 interface IUniswapV2Locker {
3132   struct UserInfo {
3133     EnumerableSet.AddressSet lockedTokens; // records all tokens the user has locked
3134     mapping(address => uint256[]) locksForToken; // map erc20 address to lock id for that token
3135   }
3136 
3137   struct TokenLock {
3138     uint256 lockDate; // the date the token was locked
3139     uint256 amount; // the amount of tokens still locked (initialAmount minus withdrawls)
3140     uint256 initialAmount; // the initial lock amount
3141     uint256 unlockDate; // the date the token can be withdrawn
3142     uint256 lockID; // lockID nonce per uni pair
3143     address owner;
3144   }
3145 
3146   struct FeeStruct {
3147     uint256 ethFee; // Small eth fee to prevent spam on the platform
3148     IERCBurn secondaryFeeToken; // UNCX or UNCL
3149     uint256 secondaryTokenFee; // optional, UNCX or UNCL
3150     uint256 secondaryTokenDiscount; // discount on liquidity fee for burning secondaryToken
3151     uint256 liquidityFee; // fee on univ2 liquidity tokens
3152     uint256 referralPercent; // fee for referrals
3153     IERCBurn referralToken; // token the refferer must hold to qualify as a referrer
3154     uint256 referralHold; // balance the referrer must hold to qualify as a referrer
3155     uint256 referralDiscount; // discount on flatrate fees for using a valid referral address
3156   }
3157 
3158   function setDev(address payable _devaddr) external;
3159 
3160   /**
3161    * @notice set the migrator contract which allows locked lp tokens to be migrated to uniswap v3
3162    */
3163   function setMigrator(IMigrator _migrator) external;
3164 
3165   function setSecondaryFeeToken(address _secondaryFeeToken) external;
3166 
3167   /**
3168    * @notice referrers need to hold the specified token and hold amount to be elegible for referral fees
3169    */
3170   function setReferralTokenAndHold(
3171     IERCBurn _referralToken,
3172     uint256 _hold
3173   ) external;
3174 
3175   function setFees(
3176     uint256 _referralPercent,
3177     uint256 _referralDiscount,
3178     uint256 _ethFee,
3179     uint256 _secondaryTokenFee,
3180     uint256 _secondaryTokenDiscount,
3181     uint256 _liquidityFee
3182   ) external;
3183 
3184   /**
3185    * @notice whitelisted accounts dont pay flatrate fees on locking
3186    */
3187   function whitelistFeeAccount(address _user, bool _add) external;
3188 
3189   /**
3190    * @notice Creates a new lock
3191    * @param _lpToken the univ2 token address
3192    * @param _amount amount of LP tokens to lock
3193    * @param _unlock_date the unix timestamp (in seconds) until unlock
3194    * @param _referral the referrer address if any or address(0) for none
3195    * @param _fee_in_eth fees can be paid in eth or in a secondary token such as UNCX with a discount on univ2 tokens
3196    * @param _withdrawer the user who can withdraw liquidity once the lock expires.
3197    */
3198   function lockLPToken(
3199     address _lpToken,
3200     uint256 _amount,
3201     uint256 _unlock_date,
3202     address payable _referral,
3203     bool _fee_in_eth,
3204     address payable _withdrawer
3205   ) external payable;
3206 
3207   /**
3208    * @notice extend a lock with a new unlock date, _index and _lockID ensure the correct lock is changed
3209    * this prevents errors when a user performs multiple tx per block possibly with varying gas prices
3210    */
3211   function relock(
3212     address _lpToken,
3213     uint256 _index,
3214     uint256 _lockID,
3215     uint256 _unlock_date
3216   ) external;
3217 
3218   /**
3219    * @notice withdraw a specified amount from a lock. _index and _lockID ensure the correct lock is changed
3220    * this prevents errors when a user performs multiple tx per block possibly with varying gas prices
3221    */
3222   function withdraw(
3223     address _lpToken,
3224     uint256 _index,
3225     uint256 _lockID,
3226     uint256 _amount
3227   ) external;
3228 
3229   /**
3230    * @notice increase the amount of tokens per a specific lock, this is preferable to creating a new lock, less fees, and faster loading on our live block explorer
3231    */
3232   function incrementLock(
3233     address _lpToken,
3234     uint256 _index,
3235     uint256 _lockID,
3236     uint256 _amount
3237   ) external;
3238 
3239   /**
3240    * @notice split a lock into two seperate locks, useful when a lock is about to expire and youd like to relock a portion
3241    * and withdraw a smaller portion
3242    */
3243   function splitLock(
3244     address _lpToken,
3245     uint256 _index,
3246     uint256 _lockID,
3247     uint256 _amount
3248   ) external payable;
3249 
3250   /**
3251    * @notice transfer a lock to a new owner, e.g. presale project -> project owner
3252    */
3253   function transferLockOwnership(
3254     address _lpToken,
3255     uint256 _index,
3256     uint256 _lockID,
3257     address payable _newOwner
3258   ) external;
3259 
3260   /**
3261    * @notice migrates liquidity to uniswap v3
3262    */
3263   function migrate(
3264     address _lpToken,
3265     uint256 _index,
3266     uint256 _lockID,
3267     uint256 _amount
3268   ) external;
3269 
3270   function getNumLocksForToken(
3271     address _lpToken
3272   ) external view returns (uint256);
3273 
3274   function getNumLockedTokens() external view returns (uint256);
3275 
3276   function getLockedTokenAtIndex(
3277     uint256 _index
3278   ) external view returns (address);
3279 
3280   // user functions
3281   function getUserNumLockedTokens(
3282     address _user
3283   ) external view returns (uint256);
3284 
3285   function getUserLockedTokenAtIndex(
3286     address _user,
3287     uint256 _index
3288   ) external view returns (address);
3289 
3290   function getUserNumLocksForToken(
3291     address _user,
3292     address _lpToken
3293   ) external view returns (uint256);
3294 
3295   function getUserLockForTokenAtIndex(
3296     address _user,
3297     address _lpToken,
3298     uint256 _index
3299   )
3300     external
3301     view
3302     returns (uint256, uint256, uint256, uint256, uint256, address);
3303 
3304   // whitelist
3305   function getWhitelistedUsersLength() external view returns (uint256);
3306 
3307   function getWhitelistedUserAtIndex(
3308     uint256 _index
3309   ) external view returns (address);
3310 
3311   function getUserWhitelistStatus(address _user) external view returns (bool);
3312 }
3313 
3314 
3315 // File contracts/ERC20FactoryV1/ERC20/ERC20ByMetadropV1.sol
3316 
3317 
3318 pragma solidity 0.8.19;
3319 /**
3320  * @dev Metadrop core ERC-20 contract
3321  *
3322  * @dev Implementation of the {IERC20} interface.
3323  *
3324  * This implementation is agnostic to the way tokens are created. This means
3325  * that a supply mechanism has to be added in a derived contract using {_mint}.
3326  * For a generic mechanism see {ERC20PresetMinterPauser}.
3327  *
3328  * TIP: For a detailed writeup see our guide
3329  * https://forum.openzeppelin.com/t/how-to-implement-erc20-supply-mechanisms/226[How
3330  * to implement supply mechanisms].
3331  *
3332  * The default value of {decimals} is 18. To change this, you should override
3333  * this function so it returns a different value.
3334  *
3335  * We have followed general OpenZeppelin Contracts guidelines: functions revert
3336  * instead returning `false` on failure. This behavior is nonetheless
3337  * conventional and does not conflict with the expectations of ERC20
3338  * applications.
3339  *
3340  * Additionally, an {Approval} event is emitted on calls to {transferFrom}.
3341  * This allows applications to reconstruct the allowance for all accounts just
3342  * by listening to said events. Other implementations of the EIP may not emit
3343  * these events, as it isn't required by the specification.
3344  *
3345  * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}
3346  * functions have been added to mitigate the well-known issues around setting
3347  * allowances. See {IERC20-approve}.
3348  */
3349 contract ERC20ByMetadropV1 is
3350   Context,
3351   ERC20Spendable,
3352   IERC20ByMetadropV1,
3353   Ownable,
3354   TaxAdmin
3355 {
3356   using EnumerableSet for EnumerableSet.AddressSet;
3357   using SafeERC20 for IERC20;
3358 
3359   uint256 public constant version = 100010001000000000;
3360   uint256 internal constant BP_DENOM = 10000;
3361   uint256 internal constant ROUND_DEC = 100000000000;
3362 
3363   IUniswapV2Locker internal immutable unicryptLocker;
3364   IUniswapV2Router02 internal immutable uniswapRouter;
3365   uint256 public immutable lpSupply;
3366   uint256 public immutable projectSupply;
3367   uint256 public immutable maxTokensPerTransaction;
3368   uint256 public immutable maxTokensPerWallet;
3369   uint256 public immutable maxProjectBuyTaxBasisPoints;
3370   uint256 public immutable maxProjectSellTaxBasisPoints;
3371   uint256 public immutable maxMetadropBuyTaxBasisPoints;
3372   uint256 public immutable maxMetadropSellTaxBasisPoints;
3373   uint256 public immutable lpLockupInDays;
3374   address public immutable metadropTreasury;
3375   address public immutable uniswapV2Pair;
3376   address internal immutable metadropV1Factory;
3377   uint256 internal immutable metadropTaxPeriodInDays;
3378   bool internal immutable tokenHasTax;
3379   bool internal immutable tokenHasLimits;
3380 
3381   /** @dev {Storage Slot 1} Vars read / written as part of transfers packed to a single
3382    * slot for warm reads / writes.
3383    *   Slot 1:
3384    *      128
3385    *       32
3386    *   16 * 5
3387    *    8 * 2
3388    *   ------
3389    *      256
3390    *   ------ */
3391   uint128 public projectTaxPendingSwap;
3392   uint32 public fundedDate;
3393   uint16 public projectBuyTaxBasisPoints;
3394   uint16 public projectSellTaxBasisPoints;
3395   uint16 public metadropBuyTaxBasisPoints;
3396   uint16 public metadropSellTaxBasisPoints;
3397   uint16 public swapThresholdBasisPoints;
3398   /** @dev {autoSwapEnabled} We start with {autoSwapEnabled} OFF, as we don't want to
3399    * call this when  processing initial liquidity from this address. We turn this on when
3400    * liquidity has been loaded, and use this bool to control processing during auto-swaps
3401    * from that point onwards. */
3402   bool private autoSwapEnabled = false;
3403 
3404   /** @dev {limitsEnabled} Similarly, we don't validate txn limits during liquidity loading. This is
3405    * automatically set to true when liquidity loading is complete.
3406    *
3407    * This can be set back to false by the tax admin. This is a neccesary fallback
3408    * position where on-chain actions cannot meet the validation and need to occur.
3409    * For example, someone may stake token into a staking contract over a number
3410    * of transactions until the staked balance is higher than the per txn limit.
3411    * If the developer of the staking contract has not considered the per txn
3412    * limit, and the 'unstake' method simply remits the entire user balance in
3413    * one txn, then this token would now be trapped in the staking contract. Under
3414    * these circumstances the limit can be turned off to allow the transaction to
3415    * proceed.
3416    *
3417    * After a given amount of time any successful token will have
3418    * become distributed such that a per transaction limit is less relevant. */
3419   bool private limitsEnabled = false;
3420 
3421   /** @dev {Storage Slot 2} Not read in transfers etc:
3422    *      160
3423    *   ------
3424    *      160
3425    *   ------ */
3426   address public projectTreasury;
3427 
3428   /** @dev {Storage Slot 3} Only written to if metadrop tax applies, otherwise no writes occur.
3429    * Note that although a uint128 supply limit applies to this contract we store this
3430    * as a uint256. As the evm uses uint256 for all vars we save the gas cost of the
3431    * implicit cast by using uint256, given there are no other vars we can sensibly
3432    * pack with. For the project tax we pack a uint128 with other vars read and written
3433    * as part of transfer processing, allowing a warm write.
3434    *   Slot 3:
3435    *      256
3436    *   ------
3437    *      256
3438    *   ------ */
3439   uint256 public metadropTaxPendingSwap;
3440 
3441   /** @dev {Storage Slot 4} Not read as part of transfers etc.
3442    *    256
3443    * ------
3444    *    256
3445    * ------ */
3446   uint256 private _totalSupply;
3447 
3448   /** @dev {Storage Slot 5 to n} Not read as part of transfers etc. */
3449   string private _name;
3450   string private _symbol;
3451 
3452   /** @dev {Social Links} These shouldn't have _ prefix as they are public, but we want these at the top */
3453   string public _1___website;
3454   string public _2___twitter;
3455   string public _3___telegram;
3456   string public _4___discord;
3457 
3458   /** @dev {_balances} Addresses balances */
3459   mapping(address => uint256) private _balances;
3460 
3461   /** @dev {_allowances} Addresses allocance details */
3462   mapping(address => mapping(address => uint256)) private _allowances;
3463 
3464   /** @dev {_liquidityPools} Enumerable set for liquidity pool addresses */
3465   EnumerableSet.AddressSet private _liquidityPools;
3466 
3467   /** @dev {_liquidityPools} Enumerable set for addresses where limits do not apply */
3468   EnumerableSet.AddressSet private _unlimited;
3469 
3470   /**
3471    * @dev {constructor}
3472    *
3473    * @param integrationAddresses_ The project owner, uniswap router and unicrypt locker.
3474    * @param baseParams_ configuration of this ERC20.
3475    * @param supplyParams_ Supply configuration of this ERC20.
3476    * @param taxParams_  Tax configuration of this ERC20
3477    */
3478   constructor(
3479     address[3] memory integrationAddresses_,
3480     bytes memory baseParams_,
3481     bytes memory supplyParams_,
3482     bytes memory taxParams_
3483   ) {
3484     _decodeBaseParams(integrationAddresses_[0], baseParams_);
3485     uniswapRouter = IUniswapV2Router02(integrationAddresses_[1]);
3486     unicryptLocker = IUniswapV2Locker(integrationAddresses_[2]);
3487 
3488     ERC20SupplyParameters memory supplyParams = abi.decode(
3489       supplyParams_,
3490       (ERC20SupplyParameters)
3491     );
3492 
3493     ERC20TaxParameters memory taxParams = abi.decode(
3494       taxParams_,
3495       (ERC20TaxParameters)
3496     );
3497 
3498     tokenHasLimits = _processSupplyParams(supplyParams);
3499     projectTreasury = supplyParams.projectTreasury;
3500     metadropTreasury = supplyParams.metadropTreasury;
3501     lpSupply = supplyParams.lpSupply * (10 ** decimals());
3502     projectSupply = supplyParams.projectSupply * (10 ** decimals());
3503     maxTokensPerWallet = supplyParams.maxTokensPerWallet * (10 ** decimals());
3504     maxTokensPerTransaction = supplyParams.maxTokensPerTxn * (10 ** decimals());
3505     lpLockupInDays = supplyParams.lpLockupInDays;
3506 
3507     tokenHasTax = _processTaxParams(taxParams);
3508     maxProjectBuyTaxBasisPoints = taxParams.maxProjectBuyTaxBasisPoints;
3509     maxProjectSellTaxBasisPoints = taxParams.maxProjectSellTaxBasisPoints;
3510     maxMetadropBuyTaxBasisPoints = taxParams.maxMetadropBuyTaxBasisPoints;
3511     maxMetadropSellTaxBasisPoints = taxParams.maxMetadropSellTaxBasisPoints;
3512     metadropTaxPeriodInDays = taxParams.metadropTaxPeriodInDays;
3513     swapThresholdBasisPoints = uint16(taxParams.taxSwapThresholdBasisPoints);
3514 
3515     metadropV1Factory = _msgSender();
3516 
3517     _mintBalances(lpSupply, projectSupply);
3518 
3519     uniswapV2Pair = _createPair();
3520   }
3521 
3522   /**
3523    * @dev {onlyOwnerOrFactory}
3524    *
3525    * Throws if called by any account other than the owner OR factory.
3526    */
3527   modifier onlyOwnerOrFactory() {
3528     if (metadropV1Factory != _msgSender() && owner() != _msgSender()) {
3529       _revert(CallerIsNotFactoryOrProjectOwner.selector);
3530     }
3531     _;
3532   }
3533 
3534   /**
3535    * @dev function {_decodeBaseParams}
3536    *
3537    * Decode NFT Parameters
3538    *
3539    * @param projectOwner_ The owner of this contract
3540    * @param encodedBaseParams_ The base params encoded into a bytes array
3541    */
3542   function _decodeBaseParams(
3543     address projectOwner_,
3544     bytes memory encodedBaseParams_
3545   ) internal {
3546     _transferOwnership(projectOwner_);
3547     _transferTaxAdmin(projectOwner_);
3548 
3549     (
3550       _name,
3551       _symbol,
3552       _1___website,
3553       _2___twitter,
3554       _3___telegram,
3555       _4___discord
3556     ) = abi.decode(
3557       encodedBaseParams_,
3558       (string, string, string, string, string, string)
3559     );
3560   }
3561 
3562   /**
3563    * @dev function {_processSupplyParams}
3564    *
3565    * Process provided supply params
3566    *
3567    * @param erc20SupplyParameters_ The supply params encoded into a bytes array
3568    */
3569   function _processSupplyParams(
3570     ERC20SupplyParameters memory erc20SupplyParameters_
3571   ) internal returns (bool tokenHasLimits_) {
3572     if (
3573       erc20SupplyParameters_.maxSupply !=
3574       (erc20SupplyParameters_.lpSupply + erc20SupplyParameters_.projectSupply)
3575     ) {
3576       _revert(SupplyTotalMismatch.selector);
3577     }
3578 
3579     if (erc20SupplyParameters_.maxSupply > type(uint128).max) {
3580       _revert(MaxSupplyTooHigh.selector);
3581     }
3582 
3583     if (erc20SupplyParameters_.lpLockupInDays > type(uint96).max) {
3584       _revert(LPLockUpMustFitUint96.selector);
3585     }
3586 
3587     _unlimited.add(erc20SupplyParameters_.projectTreasury);
3588     _unlimited.add(address(this));
3589     _unlimited.add(address(0));
3590 
3591     if (
3592       erc20SupplyParameters_.maxTokensPerTxn == 0 &&
3593       erc20SupplyParameters_.maxTokensPerWallet == 0
3594     ) {
3595       return false;
3596     } else {
3597       return true;
3598     }
3599   }
3600 
3601   /**
3602    * @dev function {_processTaxParams}
3603    *
3604    * Process provided tax params
3605    *
3606    * @param erc20TaxParameters_ The tax params encoded into a bytes array
3607    */
3608   function _processTaxParams(
3609     ERC20TaxParameters memory erc20TaxParameters_
3610   ) internal returns (bool tokenHasTax_) {
3611     /**
3612      * @dev We use the immutable var {tokenHasTax} to avoid unneccesary storage writes and reads. If this
3613      * token does NOT have tax applied then there is no need to store or read these parameters, and we can
3614      * avoid this simply by checking the immutable var. Pass back the value for this var from this method.
3615      */
3616     if (
3617       erc20TaxParameters_.projectBuyTaxBasisPoints == 0 &&
3618       erc20TaxParameters_.projectSellTaxBasisPoints == 0 &&
3619       erc20TaxParameters_.metadropBuyTaxBasisPoints == 0 &&
3620       erc20TaxParameters_.metadropSellTaxBasisPoints == 0 &&
3621       erc20TaxParameters_.maxProjectBuyTaxBasisPoints == 0 &&
3622       erc20TaxParameters_.maxProjectSellTaxBasisPoints == 0 &&
3623       erc20TaxParameters_.maxMetadropBuyTaxBasisPoints == 0 &&
3624       erc20TaxParameters_.maxMetadropSellTaxBasisPoints == 0
3625     ) {
3626       return false;
3627     } else {
3628       projectBuyTaxBasisPoints = uint16(
3629         erc20TaxParameters_.projectBuyTaxBasisPoints
3630       );
3631       projectSellTaxBasisPoints = uint16(
3632         erc20TaxParameters_.projectSellTaxBasisPoints
3633       );
3634       metadropBuyTaxBasisPoints = uint16(
3635         erc20TaxParameters_.metadropBuyTaxBasisPoints
3636       );
3637       metadropSellTaxBasisPoints = uint16(
3638         erc20TaxParameters_.metadropSellTaxBasisPoints
3639       );
3640       return true;
3641     }
3642   }
3643 
3644   /**
3645    * @dev function {_mintBalances}
3646    *
3647    * Mint initial balances
3648    *
3649    * @param lpMint_ The number of tokens for liquidity
3650    * @param projectMint_ The number of tokens for the project treasury
3651    */
3652   function _mintBalances(uint256 lpMint_, uint256 projectMint_) internal {
3653     if (lpMint_ > 0) {
3654       _mint(address(this), lpMint_);
3655     }
3656     if (projectMint_ > 0) {
3657       _mint(projectTreasury, projectMint_);
3658     }
3659   }
3660 
3661   /**
3662    * @dev function {_createPair}
3663    *
3664    * Create the uniswap pair
3665    *
3666    * @return uniswapV2Pair_ The pair address
3667    */
3668   function _createPair() internal returns (address uniswapV2Pair_) {
3669     if (_totalSupply > 0) {
3670       uniswapV2Pair_ = IUniswapV2Factory(uniswapRouter.factory()).createPair(
3671         address(this),
3672         uniswapRouter.WETH()
3673       );
3674 
3675       _liquidityPools.add(uniswapV2Pair_);
3676       emit LiquidityPoolCreated(uniswapV2Pair_);
3677     }
3678     _unlimited.add(address(uniswapRouter));
3679     _unlimited.add(uniswapV2Pair_);
3680     return (uniswapV2Pair_);
3681   }
3682 
3683   /**
3684    * @dev function {addInitialLiquidity}
3685    *
3686    * Add initial liquidity to the uniswap pair
3687    *
3688    * @param lockerFee_ The locker fee in wei. This must match the required fee from the external locker contract.
3689    */
3690   function addInitialLiquidity(
3691     uint256 lockerFee_
3692   ) public payable onlyOwnerOrFactory {
3693     if (lockerFee_ >= msg.value) {
3694       // The amount of ETH MUST exceed the locker fee, otherwise what liquidity are we adding?
3695       _revert(NoETHForLiquidityPair.selector);
3696     }
3697     _addInitialLiquidity((msg.value - lockerFee_), lockerFee_);
3698   }
3699 
3700   /**
3701    * @dev function {_addInitialLiquidity}
3702    *
3703    * Add initial liquidity to the uniswap pair (internal function that does the work)
3704    *
3705    * @param ethAmount_ The amount of ETH passed into the call
3706    * @param lockerFee_ The locker fee in wei. This must match the required fee from the external locker contract.
3707    */
3708   function _addInitialLiquidity(
3709     uint256 ethAmount_,
3710     uint256 lockerFee_
3711   ) internal {
3712     // Funded date is the date of first funding. We can only add initial liquidity once. If this date is set,
3713     // we cannot proceed
3714     if (fundedDate == 0) {
3715       fundedDate = uint32(block.timestamp);
3716     } else {
3717       _revert(InitialLiquidityAlreadyAdded.selector);
3718     }
3719 
3720     // Can only do this if this contract holds tokens:
3721     if (balanceOf(address(this)) == 0) {
3722       _revert(NoTokenForLiquidityPair.selector);
3723     }
3724 
3725     // Approve the uniswap router for an inifinite amount (max uint256)
3726     // This means that we don't need to worry about later incrememtal
3727     // approvals on tax swaps, as the uniswap router allowance will never
3728     // be decreased (see code in decreaseAllowance for reference)
3729     _approve(address(this), address(uniswapRouter), type(uint256).max);
3730 
3731     // Add the liquidity:
3732     (uint256 amountA, uint256 amountB, uint256 lpTokens) = uniswapRouter
3733       .addLiquidityETH{value: ethAmount_}(
3734       address(this),
3735       balanceOf(address(this)),
3736       0,
3737       0,
3738       address(this),
3739       block.timestamp
3740     );
3741 
3742     emit InitialLiquidityAdded(amountA, amountB, lpTokens);
3743 
3744     autoSwapEnabled = true;
3745     limitsEnabled = true;
3746 
3747     // Lock the liqidity:
3748     _lockInitialLiquidity(lockerFee_, lpTokens);
3749   }
3750 
3751   /**
3752    * @dev function {_lockInitialLiquidity}
3753    *
3754    * Lock initial liquidity on locker contract
3755    *
3756    * @param lockerFee_ The locker fee in wei. This must match the required fee from the external locker contract.
3757    * @param lpTokens_ The amount of LP tokens to be locked
3758    */
3759   function _lockInitialLiquidity(
3760     uint256 lockerFee_,
3761     uint256 lpTokens_
3762   ) internal {
3763     IERC20(uniswapV2Pair).approve(address(unicryptLocker), lpTokens_);
3764 
3765     unicryptLocker.lockLPToken{value: lockerFee_}(
3766       uniswapV2Pair,
3767       IERC20(uniswapV2Pair).balanceOf(address(this)),
3768       block.timestamp + (lpLockupInDays * 1 days),
3769       payable(address(0)),
3770       true,
3771       payable(projectTreasury)
3772     );
3773 
3774     emit LiquidityLocked();
3775   }
3776 
3777   /**
3778    * @dev function {isLiquidityPool}
3779    *
3780    * Return if an address is a liquidity pool
3781    *
3782    * @param queryAddress_ The address being queried
3783    * @return bool The address is / isn't a liquidity pool
3784    */
3785   function isLiquidityPool(address queryAddress_) public view returns (bool) {
3786     /** @dev We check the uniswapV2Pair address first as this is an immutable variable and therefore does not need
3787      * to be fetched from storage, saving gas if this address IS the uniswapV2Pool. We also add this address
3788      * to the enumerated set for ease of reference (for example it is returned in the getter), and it does
3789      * not add gas to any other calls, that still complete in 0(1) time.
3790      */
3791     return (queryAddress_ == uniswapV2Pair ||
3792       _liquidityPools.contains(queryAddress_));
3793   }
3794 
3795   /**
3796    * @dev function {addLiquidityPool} onlyTaxAdmin
3797    *
3798    * Allows the tax admin to add a liquidity pool to the pool enumerable set
3799    *
3800    * @param newLiquidityPool_ The address of the new liquidity pool
3801    */
3802   function addLiquidityPool(address newLiquidityPool_) public onlyTaxAdmin {
3803     // Don't allow calls that didn't pass an address:
3804     if (newLiquidityPool_ == address(0)) {
3805       _revert(LiquidityPoolCannotBeAddressZero.selector);
3806     }
3807     // Only allow smart contract addresses to be added, as only these can be pools:
3808     if (newLiquidityPool_.code.length == 0) {
3809       _revert(LiquidityPoolMustBeAContractAddress.selector);
3810     }
3811     // Add this to the enumerated list:
3812     _liquidityPools.add(newLiquidityPool_);
3813     emit LiquidityPoolAdded(newLiquidityPool_);
3814   }
3815 
3816   /**
3817    * @dev function {removeLiquidityPool} onlyTaxAdmin
3818    *
3819    * Allows the tax admin to remove a liquidity pool
3820    *
3821    * @param removedLiquidityPool_ The address of the old removed liquidity pool
3822    */
3823   function removeLiquidityPool(
3824     address removedLiquidityPool_
3825   ) public onlyTaxAdmin {
3826     // Remove this from the enumerated list:
3827     _liquidityPools.remove(removedLiquidityPool_);
3828     emit LiquidityPoolRemoved(removedLiquidityPool_);
3829   }
3830 
3831   /**
3832    * @dev function {isUnlimited}
3833    *
3834    * Return if an address is unlimited (is not subject to per txn and per wallet limits)
3835    *
3836    * @param queryAddress_ The address being queried
3837    * @return bool The address is / isn't unlimited
3838    */
3839   function isUnlimited(address queryAddress_) public view returns (bool) {
3840     return (_unlimited.contains(queryAddress_));
3841   }
3842 
3843   /**
3844    * @dev function {addUnlimited} onlyTaxAdmin
3845    *
3846    * Allows the tax admin to add an unlimited address
3847    *
3848    * @param newUnlimited_ The address of the new unlimited address
3849    */
3850   function addUnlimited(address newUnlimited_) public onlyTaxAdmin {
3851     // Add this to the enumerated list:
3852     _unlimited.add(newUnlimited_);
3853     emit UnlimitedAddressAdded(newUnlimited_);
3854   }
3855 
3856   /**
3857    * @dev function {removeUnlimited} onlyTaxAdmin
3858    *
3859    * Allows the tax admin to remove an unlimited address
3860    *
3861    * @param removedUnlimited_ The address of the old removed unlimited address
3862    */
3863   function removeUnlimited(address removedUnlimited_) public onlyTaxAdmin {
3864     // Remove this from the enumerated list:
3865     _unlimited.remove(removedUnlimited_);
3866     emit UnlimitedAddressRemoved(removedUnlimited_);
3867   }
3868 
3869   /**
3870    * @dev function {setLimitsEnabledStatus} onlyTaxAdmin
3871    *
3872    * Allows the tax admin to enable / disable tokens per txn and per holder validation.
3873    *
3874    * @param enabled_ Should limits be on?
3875    */
3876   function setLimitsEnabledStatus(bool enabled_) public onlyTaxAdmin {
3877     limitsEnabled = enabled_;
3878     emit SetLimitsEnabled(enabled_);
3879   }
3880 
3881   /**
3882    * @dev function {setProjectTreasury} onlyTaxAdmin
3883    *
3884    * Allows the tax admin to set the treasury address
3885    *
3886    * @param projectTreasury_ New treasury address
3887    */
3888   function setProjectTreasury(address projectTreasury_) public onlyTaxAdmin {
3889     projectTreasury = projectTreasury_;
3890     emit TreasuryUpdated(projectTreasury_);
3891   }
3892 
3893   /**
3894    * @dev function {setSwapThresholdBasisPoints} onlyTaxAdmin
3895    *
3896    * Allows the tax admin to set the autoswap threshold
3897    *
3898    * @param swapThresholdBasisPoints_ New swap threshold in basis points
3899    */
3900   function setSwapThresholdBasisPoints(
3901     uint16 swapThresholdBasisPoints_
3902   ) public onlyTaxAdmin {
3903     uint256 oldswapThresholdBasisPoints = swapThresholdBasisPoints;
3904     swapThresholdBasisPoints = swapThresholdBasisPoints_;
3905     emit AutoSwapThresholdUpdated(
3906       oldswapThresholdBasisPoints,
3907       swapThresholdBasisPoints_
3908     );
3909   }
3910 
3911   /**
3912    * @dev function {withdrawETH} onlyOwner
3913    *
3914    * Allows the owner to withdraw ETH
3915    *
3916    * @param amount_ The amount to withdraw
3917    */
3918   function withdrawETH(uint256 amount_) external onlyOwner {
3919     (bool success, ) = owner().call{value: amount_}("");
3920     if (!success) {
3921       _revert(TransferFailed.selector);
3922     }
3923   }
3924 
3925   /**
3926    * @dev function {withdrawERC20} onlyOwner
3927    *
3928    * A withdraw function to allow ERC20s to be withdrawn.
3929    *
3930    * @param token_ The address of the token being withdrawn
3931    * @param amount_ The amount to withdraw
3932    */
3933   function withdrawERC20(IERC20 token_, uint256 amount_) external onlyOwner {
3934     token_.safeTransfer(owner(), amount_);
3935   }
3936 
3937   /**
3938    * @dev function {setProjectTaxRates} onlyTaxAdmin
3939    *
3940    * Change the tax rates, subject to max rate
3941    *
3942    * @param newProjectBuyTaxBasisPoints_ The new buy tax rate
3943    * @param newProjectSellTaxBasisPoints_ The new sell tax rate
3944    */
3945   function setProjectTaxRates(
3946     uint16 newProjectBuyTaxBasisPoints_,
3947     uint16 newProjectSellTaxBasisPoints_
3948   ) external onlyTaxAdmin {
3949     // Cannot increase above the maximum:
3950     if (newProjectBuyTaxBasisPoints_ > maxProjectBuyTaxBasisPoints) {
3951       _revert(NewBuyTaxBasisPointsExceedsMaximum.selector);
3952     }
3953     // Cannot increase above the maximum:
3954     if (newProjectSellTaxBasisPoints_ > maxProjectSellTaxBasisPoints) {
3955       _revert(NewSellTaxBasisPointsExceedsMaximum.selector);
3956     }
3957 
3958     uint16 oldBuyTaxBasisPoints = projectBuyTaxBasisPoints;
3959     projectBuyTaxBasisPoints = newProjectBuyTaxBasisPoints_;
3960 
3961     uint16 oldSellTaxBasisPoints = projectSellTaxBasisPoints;
3962     projectSellTaxBasisPoints = newProjectSellTaxBasisPoints_;
3963 
3964     emit ProjectTaxBasisPointsChanged(
3965       oldBuyTaxBasisPoints,
3966       newProjectBuyTaxBasisPoints_,
3967       oldSellTaxBasisPoints,
3968       newProjectSellTaxBasisPoints_
3969     );
3970   }
3971 
3972   /**
3973    * @dev function {setMetadropTaxRates} onlyTaxAdmin
3974    *
3975    * Change the tax rates, subject to max rate and minimum tax period.
3976    *
3977    * @param newMetadropBuyTaxBasisPoints_ The new buy tax rate
3978    * @param newMetadropSellTaxBasisPoints_ The new sell tax rate
3979    */
3980   function setMetadropTaxRates(
3981     uint16 newMetadropBuyTaxBasisPoints_,
3982     uint16 newMetadropSellTaxBasisPoints_
3983   ) external onlyTaxAdmin {
3984     // Cannot increase above the maximum:
3985     if (newMetadropBuyTaxBasisPoints_ > maxMetadropBuyTaxBasisPoints) {
3986       _revert(NewBuyTaxBasisPointsExceedsMaximum.selector);
3987     }
3988 
3989     // Cannot increase above the maximum:
3990     if (newMetadropSellTaxBasisPoints_ > maxMetadropSellTaxBasisPoints) {
3991       _revert(NewSellTaxBasisPointsExceedsMaximum.selector);
3992     }
3993 
3994     // Reducing the basis points can only occur after the tax period:
3995     if (
3996       (newMetadropBuyTaxBasisPoints_ < metadropBuyTaxBasisPoints ||
3997         newMetadropSellTaxBasisPoints_ < metadropSellTaxBasisPoints) &&
3998       block.timestamp < (fundedDate + (metadropTaxPeriodInDays * 1 days))
3999     ) {
4000       _revert(TaxPeriodStillInForce.selector);
4001     }
4002 
4003     uint16 oldBuyTaxBasisPoints = metadropBuyTaxBasisPoints;
4004     uint16 oldSellTaxBasisPoints = metadropSellTaxBasisPoints;
4005 
4006     metadropBuyTaxBasisPoints = newMetadropBuyTaxBasisPoints_;
4007     metadropSellTaxBasisPoints = newMetadropSellTaxBasisPoints_;
4008 
4009     emit MetadropTaxBasisPointsChanged(
4010       oldBuyTaxBasisPoints,
4011       newMetadropBuyTaxBasisPoints_,
4012       oldSellTaxBasisPoints,
4013       newMetadropSellTaxBasisPoints_
4014     );
4015   }
4016 
4017   /**
4018    * @dev Returns the name of the token.
4019    */
4020   function name() public view virtual override returns (string memory) {
4021     return _name;
4022   }
4023 
4024   /**
4025    * @dev Returns the symbol of the token, usually a shorter version of the
4026    * name.
4027    */
4028   function symbol() public view virtual override returns (string memory) {
4029     return _symbol;
4030   }
4031 
4032   /**
4033    * @dev Returns the number of decimals used to get its user representation.
4034    * For example, if `decimals` equals `2`, a balance of `505` tokens should
4035    * be displayed to a user as `5.05` (`505 / 10 ** 2`).
4036    *
4037    * Tokens usually opt for a value of 18, imitating the relationship between
4038    * Ether and Wei. This is the default value returned by this function, unless
4039    * it's overridden.
4040    *
4041    * NOTE: This information is only used for _display_ purposes: it in
4042    * no way affects any of the arithmetic of the contract, including
4043    * {IERC20-balanceOf} and {IERC20-transfer}.
4044    */
4045   function decimals() public view virtual override returns (uint8) {
4046     return 18;
4047   }
4048 
4049   /**
4050    * @dev See {IERC20-totalSupply}.
4051    */
4052   function totalSupply() public view virtual override returns (uint256) {
4053     return _totalSupply;
4054   }
4055 
4056   /**
4057    * @dev Provide easy to view tax total:
4058    */
4059   function _totalBuyTaxBasisPoints() internal view returns (uint256) {
4060     return projectBuyTaxBasisPoints + metadropBuyTaxBasisPoints;
4061   }
4062 
4063   /**
4064    * @dev Provide easy to view tax total:
4065    */
4066   function _totalSellTaxBasisPoints() internal view returns (uint256) {
4067     return projectSellTaxBasisPoints + metadropSellTaxBasisPoints;
4068   }
4069 
4070   /**
4071    * @dev See {IERC20-balanceOf}.
4072    */
4073   function balanceOf(
4074     address account
4075   ) public view virtual override returns (uint256) {
4076     return _balances[account];
4077   }
4078 
4079   /**
4080    * @dev See {IERC20-transfer}.
4081    *
4082    * Requirements:
4083    *
4084    * - `to` cannot be the zero address.
4085    * - the caller must have a balance of at least `amount`.
4086    */
4087   function transfer(
4088     address to,
4089     uint256 amount
4090   ) public virtual override(ERC20Spendable, IERC20) returns (bool) {
4091     address owner = _msgSender();
4092     _transfer(
4093       owner,
4094       to,
4095       amount,
4096       (isLiquidityPool(owner) || isLiquidityPool(to))
4097     );
4098     return true;
4099   }
4100 
4101   /**
4102    * @dev See {IERC20-allowance}.
4103    */
4104   function allowance(
4105     address owner,
4106     address spender
4107   ) public view virtual override returns (uint256) {
4108     return _allowances[owner][spender];
4109   }
4110 
4111   /**
4112    * @dev See {IERC20-approve}.
4113    *
4114    * NOTE: If `amount` is the maximum `uint256`, the allowance is not updated on
4115    * `transferFrom`. This is semantically equivalent to an infinite approval.
4116    *
4117    * Requirements:
4118    *
4119    * - `spender` cannot be the zero address.
4120    */
4121   function approve(
4122     address spender,
4123     uint256 amount
4124   ) public virtual override returns (bool) {
4125     address owner = _msgSender();
4126     _approve(owner, spender, amount);
4127     return true;
4128   }
4129 
4130   /**
4131    * @dev See {IERC20-transferFrom}.
4132    *
4133    * Emits an {Approval} event indicating the updated allowance. This is not
4134    * required by the EIP. See the note at the beginning of {ERC20}.
4135    *
4136    * NOTE: Does not update the allowance if the current allowance
4137    * is the maximum `uint256`.
4138    *
4139    * Requirements:
4140    *
4141    * - `from` and `to` cannot be the zero address.
4142    * - `from` must have a balance of at least `amount`.
4143    * - the caller must have allowance for ``from``'s tokens of at least
4144    * `amount`.
4145    */
4146   function transferFrom(
4147     address from,
4148     address to,
4149     uint256 amount
4150   ) public virtual override returns (bool) {
4151     address spender = _msgSender();
4152     _spendAllowance(from, spender, amount);
4153     _transfer(from, to, amount, (isLiquidityPool(from) || isLiquidityPool(to)));
4154     return true;
4155   }
4156 
4157   /**
4158    * @dev Atomically increases the allowance granted to `spender` by the caller.
4159    *
4160    * This is an alternative to {approve} that can be used as a mitigation for
4161    * problems described in {IERC20-approve}.
4162    *
4163    * Emits an {Approval} event indicating the updated allowance.
4164    *
4165    * Requirements:
4166    *
4167    * - `spender` cannot be the zero address.
4168    */
4169   function increaseAllowance(
4170     address spender,
4171     uint256 addedValue
4172   ) public virtual returns (bool) {
4173     address owner = _msgSender();
4174     _approve(owner, spender, allowance(owner, spender) + addedValue);
4175     return true;
4176   }
4177 
4178   /**
4179    * @dev Atomically decreases the allowance granted to `spender` by the caller.
4180    *
4181    * This is an alternative to {approve} that can be used as a mitigation for
4182    * problems described in {IERC20-approve}.
4183    *
4184    * Emits an {Approval} event indicating the updated allowance.
4185    *
4186    * Requirements:
4187    *
4188    * - `spender` cannot be the zero address.
4189    * - `spender` must have allowance for the caller of at least
4190    * `subtractedValue`.
4191    */
4192   function decreaseAllowance(
4193     address spender,
4194     uint256 subtractedValue
4195   ) public virtual returns (bool) {
4196     address owner = _msgSender();
4197     uint256 currentAllowance = allowance(owner, spender);
4198     if (currentAllowance < subtractedValue) {
4199       _revert(AllowanceDecreasedBelowZero.selector);
4200     }
4201     unchecked {
4202       _approve(owner, spender, currentAllowance - subtractedValue);
4203     }
4204 
4205     return true;
4206   }
4207 
4208   /**
4209    * @dev Moves `amount` of tokens from `from` to `to`.
4210    *
4211    * This internal function is equivalent to {transfer}, and can be used to
4212    * e.g. implement automatic token fees, slashing mechanisms, etc.
4213    *
4214    * Emits a {Transfer} event.
4215    *
4216    * Requirements:
4217    *
4218    * - `from` cannot be the zero address.
4219    * - `to` cannot be the zero address.
4220    * - `from` must have a balance of at least `amount`.
4221    */
4222   function _transfer(
4223     address from,
4224     address to,
4225     uint256 amount,
4226     bool applyTax
4227   ) internal virtual {
4228     _beforeTokenTransfer(from, to, amount);
4229 
4230     // Perform pre-tax validation (e.g. amount doesn't exceed balance, max txn amount)
4231     uint256 fromBalance = _pretaxValidationAndLimits(from, to, amount);
4232 
4233     // Perform autoswap if eligible
4234     _autoSwap(from, to);
4235 
4236     // Process taxes
4237     uint256 amountMinusTax = _taxProcessing(applyTax, to, from, amount);
4238 
4239     // Perform post-tax validation (e.g. total balance after post-tax amount applied)
4240     _posttaxValidationAndLimits(from, to, amountMinusTax);
4241 
4242     _balances[from] = fromBalance - amount;
4243     _balances[to] += amountMinusTax;
4244 
4245     emit Transfer(from, to, amountMinusTax);
4246 
4247     _afterTokenTransfer(from, to, amount);
4248   }
4249 
4250   /**
4251    * @dev function {_pretaxValidationAndLimits}
4252    *
4253    * Perform validation on pre-tax amounts
4254    *
4255    * @param from_ From address for the transaction
4256    * @param to_ To address for the transaction
4257    * @param amount_ Amount of the transaction
4258    */
4259   function _pretaxValidationAndLimits(
4260     address from_,
4261     address to_,
4262     uint256 amount_
4263   ) internal view returns (uint256 fromBalance_) {
4264     if (from_ == address(0)) {
4265       _revert(TransferFromZeroAddress.selector);
4266     }
4267 
4268     if (to_ == address(0)) {
4269       _revert(TransferToZeroAddress.selector);
4270     }
4271 
4272     fromBalance_ = _balances[from_];
4273 
4274     if (fromBalance_ < amount_) {
4275       _revert(TransferAmountExceedsBalance.selector);
4276     }
4277 
4278     // Liquidity pools aren't always going to round cleanly. This can (and does)
4279     // mean that a limit of 5,000 tokens (for example) will trigger on a transfer
4280     // of 5,000 tokens, as the transfer is actually for 5,000.00000000000000213.
4281     // While 4,999 will work fine, it isn't hugely user friendly. So we buffer
4282     // the limit with rounding decimals, which in all cases are considerably less
4283     // than one whole token:
4284     uint256 roundedLimited;
4285 
4286     unchecked {
4287       roundedLimited = maxTokensPerTransaction + ROUND_DEC;
4288     }
4289 
4290     if (
4291       tokenHasLimits &&
4292       limitsEnabled &&
4293       (maxTokensPerTransaction != 0) &&
4294       (amount_ > roundedLimited) &&
4295       ((isLiquidityPool(from_) && !isUnlimited(to_)) ||
4296         (isLiquidityPool(to_) && !isUnlimited(from_)))
4297     ) {
4298       _revert(MaxTokensPerTxnExceeded.selector);
4299     }
4300 
4301     return (fromBalance_);
4302   }
4303 
4304   /**
4305    * @dev function {_posttaxValidationAndLimits}
4306    *
4307    * Perform validation on post-tax amounts
4308    *
4309    * @param to_ To address for the transaction
4310    * @param amount_ Amount of the transaction
4311    */
4312   function _posttaxValidationAndLimits(
4313     address from_,
4314     address to_,
4315     uint256 amount_
4316   ) internal view returns (uint256 fromBalance_) {
4317     // Liquidity pools aren't always going to round cleanly. This can (and does)
4318     // mean that a limit of 5,000 tokens (for example) will trigger on a max holding
4319     // of 5,000 tokens, as the transfer to achieve that is actually for
4320     // 5,000.00000000000000213. While 4,999 will work fine, it isn't hugely user friendly.
4321     // So we buffer the limit with rounding decimals, which in all cases are considerably
4322     // less than one whole token:
4323     uint256 roundedLimited;
4324 
4325     unchecked {
4326       roundedLimited = maxTokensPerWallet + ROUND_DEC;
4327     }
4328     if (
4329       tokenHasLimits &&
4330       limitsEnabled &&
4331       (maxTokensPerWallet != 0) &&
4332       (amount_ + balanceOf(to_) > roundedLimited) &&
4333       // If this is a buy (from a liquidity pool), we apply if the to_
4334       // address isn't noted as unlimited:
4335       (isLiquidityPool(from_) && !isUnlimited(to_))
4336     ) {
4337       _revert(MaxTokensPerWalletExceeded.selector);
4338     }
4339 
4340     return (fromBalance_);
4341   }
4342 
4343   /**
4344    * @dev function {_taxProcessing}
4345    *
4346    * Perform tax processing
4347    *
4348    * @param applyTax_ Do we apply tax to this transaction?
4349    * @param to_ The reciever of the token
4350    * @param from_ The sender of the token
4351    * @param sentAmount_ The amount being send
4352    * @return amountLessTax_ The amount that will be recieved, i.e. the send amount minus tax
4353    */
4354   function _taxProcessing(
4355     bool applyTax_,
4356     address to_,
4357     address from_,
4358     uint256 sentAmount_
4359   ) internal returns (uint256 amountLessTax_) {
4360     amountLessTax_ = sentAmount_;
4361     unchecked {
4362       if (tokenHasTax && applyTax_ && autoSwapEnabled) {
4363         uint256 tax;
4364 
4365         // on sell
4366         if (isLiquidityPool(to_) && _totalSellTaxBasisPoints() > 0) {
4367           if (projectSellTaxBasisPoints > 0) {
4368             uint256 projectTax = ((sentAmount_ * projectSellTaxBasisPoints) /
4369               BP_DENOM);
4370             projectTaxPendingSwap += uint128(projectTax);
4371             tax += projectTax;
4372           }
4373           if (metadropSellTaxBasisPoints > 0) {
4374             uint256 metadropTax = ((sentAmount_ * metadropSellTaxBasisPoints) /
4375               BP_DENOM);
4376             metadropTaxPendingSwap += uint128(metadropTax);
4377             tax += metadropTax;
4378           }
4379         }
4380         // on buy
4381         else if (isLiquidityPool(from_) && _totalBuyTaxBasisPoints() > 0) {
4382           if (projectBuyTaxBasisPoints > 0) {
4383             uint256 projectTax = ((sentAmount_ * projectBuyTaxBasisPoints) /
4384               BP_DENOM);
4385             projectTaxPendingSwap += uint128(projectTax);
4386             tax += projectTax;
4387           }
4388           if (metadropBuyTaxBasisPoints > 0) {
4389             uint256 metadropTax = ((sentAmount_ * metadropBuyTaxBasisPoints) /
4390               BP_DENOM);
4391             metadropTaxPendingSwap += uint128(metadropTax);
4392             tax += metadropTax;
4393           }
4394         }
4395 
4396         if (tax > 0) {
4397           _balances[address(this)] += tax;
4398           emit Transfer(from_, address(this), tax);
4399           amountLessTax_ -= tax;
4400         }
4401       }
4402     }
4403     return (amountLessTax_);
4404   }
4405 
4406   /**
4407    * @dev function {_autoSwap}
4408    *
4409    * Automate the swap of accumulated tax fees to native token
4410    *
4411    * @param from_ The sender of the token
4412    */
4413   function _autoSwap(address from_, address to_) internal {
4414     if (tokenHasTax) {
4415       uint256 taxBalance = balanceOf(address(this));
4416 
4417       if (_eligibleForSwap(from_, to_, taxBalance)) {
4418         // Store that a swap back is in progress:
4419         autoSwapEnabled = false;
4420         // Perform the auto swap to native token:
4421         _swapTaxForNative(taxBalance);
4422         // Flag that the autoswap is complete:
4423         autoSwapEnabled = true;
4424       }
4425     }
4426   }
4427 
4428   /**
4429    * @dev function {_eligibleForSwap}
4430    *
4431    * Is the current transfer eligible for autoswap
4432    *
4433    * @param from_ The sender of the token
4434    * @param taxBalance_ The current accumulated tax balance
4435    */
4436   function _eligibleForSwap(
4437     address from_,
4438     address to_,
4439     uint256 taxBalance_
4440   ) internal view returns (bool) {
4441     return (taxBalance_ >=
4442       ((_totalSupply * swapThresholdBasisPoints) / BP_DENOM) &&
4443       autoSwapEnabled &&
4444       !isLiquidityPool(from_) &&
4445       from_ != address(uniswapRouter) &&
4446       to_ != address(uniswapRouter));
4447   }
4448 
4449   /**
4450    * @dev function {_swapTaxForNative}
4451    *
4452    * Swap tokens taken as tax for native token
4453    *
4454    * @param taxBalance_ The current accumulated tax balance
4455    */
4456   function _swapTaxForNative(uint256 taxBalance_) internal {
4457     uint256 preSwapBalance = address(this).balance;
4458 
4459     address[] memory path = new address[](2);
4460     path[0] = address(this);
4461     path[1] = uniswapRouter.WETH();
4462 
4463     uniswapRouter.swapExactTokensForETHSupportingFeeOnTransferTokens(
4464       taxBalance_,
4465       0,
4466       path,
4467       address(this),
4468       block.timestamp
4469     );
4470 
4471     uint256 postSwapBalance = address(this).balance;
4472 
4473     uint256 balanceToDistribute = postSwapBalance - preSwapBalance;
4474 
4475     uint256 projectBalanceToDistribute = (balanceToDistribute *
4476       projectTaxPendingSwap) / (projectTaxPendingSwap + metadropTaxPendingSwap);
4477 
4478     uint256 metadropBalanceToDistribute = (balanceToDistribute *
4479       metadropTaxPendingSwap) /
4480       (projectTaxPendingSwap + metadropTaxPendingSwap);
4481 
4482     (projectTaxPendingSwap, metadropTaxPendingSwap) = (0, 0);
4483 
4484     // Distribute to treasuries:
4485     bool success;
4486     (success, ) = projectTreasury.call{value: projectBalanceToDistribute}("");
4487     if (!success) {
4488       _revert(TransferFailed.selector);
4489     }
4490 
4491     (success, ) = metadropTreasury.call{value: metadropBalanceToDistribute}("");
4492     if (!success) {
4493       _revert(TransferFailed.selector);
4494     }
4495   }
4496 
4497   /** @dev Creates `amount` tokens and assigns them to `account`, increasing
4498    * the total supply.
4499    *
4500    * Emits a {Transfer} event with `from` set to the zero address.
4501    *
4502    * Requirements:
4503    *
4504    * - `account` cannot be the zero address.
4505    */
4506   function _mint(address account, uint256 amount) internal virtual {
4507     if (account == address(0)) {
4508       _revert(MintToZeroAddress.selector);
4509     }
4510 
4511     _beforeTokenTransfer(address(0), account, amount);
4512 
4513     _totalSupply += amount;
4514     unchecked {
4515       // Overflow not possible: balance + amount is at most totalSupply + amount, which is checked above.
4516       _balances[account] += amount;
4517     }
4518     emit Transfer(address(0), account, amount);
4519 
4520     _afterTokenTransfer(address(0), account, amount);
4521   }
4522 
4523   /**
4524    * @dev Destroys `amount` tokens from `account`, reducing the
4525    * total supply.
4526    *
4527    * Emits a {Transfer} event with `to` set to the zero address.
4528    *
4529    * Requirements:
4530    *
4531    * - `account` cannot be the zero address.
4532    * - `account` must have at least `amount` tokens.
4533    */
4534   function _burn(address account, uint256 amount) internal virtual {
4535     if (account == address(0)) {
4536       _revert(BurnFromTheZeroAddress.selector);
4537     }
4538 
4539     _beforeTokenTransfer(account, address(0), amount);
4540 
4541     uint256 accountBalance = _balances[account];
4542     if (accountBalance < amount) {
4543       _revert(BurnExceedsBalance.selector);
4544     }
4545 
4546     unchecked {
4547       _balances[account] = accountBalance - amount;
4548       // Overflow not possible: amount <= accountBalance <= totalSupply.
4549       _totalSupply -= amount;
4550     }
4551 
4552     emit Transfer(account, address(0), amount);
4553 
4554     _afterTokenTransfer(account, address(0), amount);
4555   }
4556 
4557   /**
4558    * @dev Sets `amount` as the allowance of `spender` over the `owner` s tokens.
4559    *
4560    * This internal function is equivalent to `approve`, and can be used to
4561    * e.g. set automatic allowances for certain subsystems, etc.
4562    *
4563    * Emits an {Approval} event.
4564    *
4565    * Requirements:
4566    *
4567    * - `owner` cannot be the zero address.
4568    * - `spender` cannot be the zero address.
4569    */
4570   function _approve(
4571     address owner,
4572     address spender,
4573     uint256 amount
4574   ) internal virtual {
4575     if (owner == address(0)) {
4576       _revert(ApproveFromTheZeroAddress.selector);
4577     }
4578 
4579     if (spender == address(0)) {
4580       _revert(ApproveToTheZeroAddress.selector);
4581     }
4582 
4583     _allowances[owner][spender] = amount;
4584     emit Approval(owner, spender, amount);
4585   }
4586 
4587   /**
4588    * @dev Updates `owner` s allowance for `spender` based on spent `amount`.
4589    *
4590    * Does not update the allowance amount in case of infinite allowance.
4591    * Revert if not enough allowance is available.
4592    *
4593    * Might emit an {Approval} event.
4594    */
4595   function _spendAllowance(
4596     address owner,
4597     address spender,
4598     uint256 amount
4599   ) internal virtual {
4600     uint256 currentAllowance = allowance(owner, spender);
4601     if (currentAllowance != type(uint256).max) {
4602       if (currentAllowance < amount) {
4603         _revert(InsufficientAllowance.selector);
4604       }
4605 
4606       unchecked {
4607         _approve(owner, spender, currentAllowance - amount);
4608       }
4609     }
4610   }
4611 
4612   /**
4613    * @dev Destroys a `value` amount of tokens from the caller.
4614    *
4615    * See {ERC20-_burn}.
4616    */
4617   function burn(uint256 value) public virtual {
4618     _burn(_msgSender(), value);
4619   }
4620 
4621   /**
4622    * @dev Destroys a `value` amount of tokens from `account`, deducting from
4623    * the caller's allowance.
4624    *
4625    * See {ERC20-_burn} and {ERC20-allowance}.
4626    *
4627    * Requirements:
4628    *
4629    * - the caller must have allowance for ``accounts``'s tokens of at least
4630    * `value`.
4631    */
4632   function burnFrom(address account, uint256 value) public virtual {
4633     _spendAllowance(account, _msgSender(), value);
4634     _burn(account, value);
4635   }
4636 
4637   /**
4638    * @dev Hook that is called before any transfer of tokens. This includes
4639    * minting and burning.
4640    *
4641    * Calling conditions:
4642    *
4643    * - when `from` and `to` are both non-zero, `amount` of ``from``'s tokens
4644    * will be transferred to `to`.
4645    * - when `from` is zero, `amount` tokens will be minted for `to`.
4646    * - when `to` is zero, `amount` of ``from``'s tokens will be burned.
4647    * - `from` and `to` are never both zero.
4648    *
4649    * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].
4650    */
4651   function _beforeTokenTransfer(
4652     address from,
4653     address to,
4654     uint256 amount
4655   ) internal virtual {}
4656 
4657   /**
4658    * @dev Hook that is called after any transfer of tokens. This includes
4659    * minting and burning.
4660    *
4661    * Calling conditions:
4662    *
4663    * - when `from` and `to` are both non-zero, `amount` of ``from``'s tokens
4664    * has been transferred to `to`.
4665    * - when `from` is zero, `amount` tokens have been minted for `to`.
4666    * - when `to` is zero, `amount` of ``from``'s tokens have been burned.
4667    * - `from` and `to` are never both zero.
4668    *
4669    * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].
4670    */
4671   function _afterTokenTransfer(
4672     address from,
4673     address to,
4674     uint256 amount
4675   ) internal virtual {}
4676 
4677   receive() external payable {}
4678 }